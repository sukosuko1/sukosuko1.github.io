<html>
<head>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
	
	<link rel="stylesheet" type="text/css" href="joininedit.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>

<iframe width="420" height="315"
src="https://www.youtube.com/embed/tgbNymZ7vqY?playsinline=1">
</iframe>

<div id="playercont">
<div id="player">
</div>
<button class="buttonpushme">replay</button>	
<input type="text" id="inputtag">
</div>

<div id="youtubesearch"></div>

<svg viewBox="0 0 100 100">
<defs>
    <linearGradient id="MyGradient" x1="0" x2="0" y1="0" y2="1">
            <stop offset="15%"  stop-color="#FFAAFF"/>
            <stop offset="95%" stop-color="blue"/>
        </linearGradient>
	
  <filter id="filter">
          <feMorphology operator="dilate" radius="4" in="SourceAlpha" result="f1"/>
<feFlood flood-color="#FFFFFF" result="WHITECOLOR" />
<feComposite operator="in" in="WHITECOLOR" in2="f1" result="f2" />

<feOffset in="f2" dx="1" dy="1" result="g1"/>
<feMorphology operator="dilate" radius="2" in="g1" result="g2"/>

<feFlood flood-color="#228844" result="DARKGREENCOLOR" />
<feComposite operator="in" in="DARKGREENCOLOR" in2="g2" result="g3" />


<feMerge>
   <feMergeNode in="g3" />
   <feMergeNode in="f2" />
   <feMergeNode in="SourceGraphic" />
</feMerge>

	</filter>
	</defs>

	
 <g class="containerpopup">
<text class="jtv" x="0" y="0" font-family="Verdana" font-size="40">Amazing!</text>
</g>

</svg>

	
  
	
 <script>
	 $("#youtubesearch").load("https://www.youtube.com/results?search_query=mexico+brazil");
	 $.get("https://www.youtube.com/results?search_query=mexico+brazil",function(data){
		console.log(data);	 
	 });
	 
	 var myData="";
$.ajax({

    url: "https://www.youtube.com/results?search_query=mexico+brazil",
    data: myData,
    type: 'GET',
    crossDomain: true,
    dataType: 'jsonp',
    success: function() { alert("Success"); },
    error: function() { alert('Failed!'); }
});
	 
	 var tagcont = document.createElement("div");
	 tagcont.id = "tagcont1";
	 document.body.appendChild(tagcont);
//      var tag = document.createElement('script');
      var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      tag.allowfullscreen = false;
      tag.enablejsapi = 1;

 //     var firstScriptTag = document.getElementsByTagName('script')[0];
//      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

   	 tagcont.appendChild(tag);

      var player;
        var vids = ["J_ub7Etch2U", "rlu3K2z5UKM", "nw5Mc5bpq-A", "a9zbC6q_EWE", "qn-X5A0gbMA", "VbfpW0pbvaU", "lYqSHHlilt8","u0fk6syQ7iY" ,"LHCob76kigA" , "m5fw380Xk6g", "iTLjnjAdYnY" ];
	 	vids = ["tPFz04LSa2U"];
	 
        var vidPtr = 0;

	 	var videoid1 = "psuRGfAaju4";
	 
      function onYouTubeIframeAPIReady() {

		  console.log("iframeready");

        player = new YT.Player('player', {
          allowfullscreen: false,
          height: '50%',
          width: '100%',
		  videoId: videoid1,
          style: 'border: solid 4px #37474F',
          loop: 'true',
          playsinline: 1,
          autoplay:1,
          enablejsapi:1,
          controls:1,
		  playerVars: {
    			rel: 0,
    			showinfo: 0,
    			fs: 0,
				modestbranding:1,
				playsinline: 1
		  },
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });

		 console.log("iframeready2")

      }

      // 4. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
		  console.log("ready")
//		  player.seekTo(124);
		  
          event.target.playVideo();
      }

      // 5. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
    var trigger = {};
    trigger.time = 5;
	 
    var triggerx = {};
    triggerx.time = 0.2;
		  
	 var playerStatus = 0;
      function onPlayerStateChange(event) {
      	playerStatus = event.data;
		  //document.getElementById("t1").innerHTML = playerStatus + " "  + player.getCurrentTime(); 
          
        vidanchortime = +new Date - 1000 * player.getCurrentTime();
		  
        console.log(playerStatus);
                                                                
    var color;
//    var c1 = document.getElementById('myCanvas');

    document.querySelector("#player").addEventListener("mousemove",onMouseUpdate)
		  
	function onMouseUpdate(event) {
  	x = event.pageX;
  	y = event.pageY;
  	console.log(x, y);
  	x = event.clientX;
  	y = event.clientY;
  	console.log("client", x, y);
		
	}
		  
	document.addEventListener("keydown", playerKeyPress);
	document.querySelector("#playercont").addEventListener("keydown", playerKeyPress);
		
	function playerKeyPress(event) {
//		console.log(event.key);
//		if (event.key == "a") player.playVideo();
//		if (event.key == "s") player.pauseVideo();
//		if (event.key == "d") player.setPlaybackRate(0.2);
		if (event.key == "d") {
			playerToggle();
		}
		if (event.key == "a") {
			player.pauseVideo();
			playerShift(-1.0);
		}
		if (event.key == "s") {
			player.pauseVideo();
			playerShift(1.0);
		}
		if (event.key == "q") {
			playerShift(-1.0);
		}
		if (event.key == "w") {
			playerShift(1.0);
		}dd
		if (event.key == "z") {
			addTag();
		}
		console.log("main : " + event.key);
	};
	
    function playerToggle() {
					  if (playerStatus == 1) {
						player.pauseVideo();	  
					  } else {
						  player.playVideo();
						  
					  }
	}
    function playerShift(t) {
		let ct = player.getCurrentTime();
		player.seekTo(ct+t);
	}
		  
    function addTag() {
   e = e || window.event;

    var pageX = e.pageX;
    var pageY = e.pageY;
		
		let ct = player.getCurrentTime();
		console.log("time" + ct);
		let e = document.querySelector("#inputtag");
		e.style.display = 'block';
//		e.style.transform = 'translate(50%,50%)'
		
		e.addEventListener("keyup", function(event) {
			console.log("gottheenter");
			event.preventDefault();
			if (event.keyCode === 13) {
				e.style.display = 'none';
			}
		});
						   
	}
		  
		  
		  var timer1;
		  function checkTime() {
			  time = player.getCurrentTime();
//		   	console.log(time);
			  
			  
		  }
		  
    if (playerStatus == -1) {
      color = "#37474F"; // unstarted = gray
    } else if (playerStatus == 0) {
		//fnished??
		//stoped
		clearInterval(timer1);
		
      nextVideo();
      color = "#FFFF00"; // ended = yellow
       c1.style.zIndex="-1";
    } else if (playerStatus == 1) {
			//playing
		timer1 = setInterval(checkTime, 500);
    } else if (playerStatus == 2) {
      color = "#DD2C00"; // paused = red
		clearInterval(timer1);
    } else if (playerStatus == 3) {
      color = "#AA00FF"; // buffering = purple
    } else if (playerStatus == 5) {
         console.log("play");       
        event.target.playVideo();
        
      color = "#FF6DOO"; // video cued = orange
    }
    if (color) {
      document.getElementById('player').style.borderColor = color;
    }
      }
      
      function stopVideo() {
        player.stopVideo();
      }
     function nextVideo() {
             vidPtr++;
        if (vidPtr >= vids.length) vidPtr = 0;
                console.log("load " + vidPtr + " " + vids[vidPtr]);

         player.loadVideoById(vids[vidPtr]);
		 if (vidPtr == 0) { player.seekTo(120+14)}
		 
     }
	 
	 window.addEventListener('load', function(event) {
		 alert("load");
		 if (localStorage.lastvideocode) {
			 currentvideo = localStorage.lastvideocode;
			 currentvideoct = localStorage.lastvideoct;
			 
			 alert(localStorage.lastvideocode);
		 }
	 });
	 
	 window.addEventListener('unload', function(event) {
		let ct = player.getCurrentTime();
		let videourl = player.getVideoUrl();
		let videocode = player.getVideoEmbedCode();
		 
		 localStorage.setItem("lastvideocode", videocode);
		 localStorage.setItem("lastvideoct", ct);
		 
		 console.log("unload!!")
      });		 
    </script>
</body>
</html>