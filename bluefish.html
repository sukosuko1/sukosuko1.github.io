<!DOCTYPE html>
<html>
<head>
<meta name="apple-mobile-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black"> 
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1, , maximum-scale=1.0, user-scalable=no, minimal-ui">

<head>
<title>pixi.js example 1</title>
	<style>
		body {
			margin: 0;
			padding: 0;
			background-color: #440022;
		}
		.embed-video { position:absolute; z-index:-1; top: 0%; width:100%; height:100%;  }
		.coverCanvas { position:absolute; z-index:-3; opacity:1.0; width:100%; height:100%; }
		
		h1    {color: white;}
	</style>

<script src="pixi.min.js"></script>
<script src="filters.js"></script>
    
</head>

<body>
  <h1 id="t1">Hello World</h1>
  <div id="outerbox">
    <div id="player" class="embed-video"></div>  
    <canvas id="myCanvas" class="coverCanvas" value="transparent"></canvas>
  </div>
  <p>Pixitest is hosted with GitHub Pages 2d.</p>
  
  <script>  
  
  console.log("text1");
  console.log(PIXI); 
//  window.alert(PIXI);
/* works on all elements except iframes */


  var gameCanvas = document.getElementById("myCanvas");
  
//  gameCanvas.addEventListener("touchmove", canvastouchmove, true);
  
   gameWidth = window.innerWidth;
   gameHeight = window.innerHeight;  
    gameWidth = 375;
   gameHeight = 667;
   
var rendererOptions = {
    view:gameCanvas,
    antialiasing:false,
    transparent:true,
    resolution:1
}  
//  var renderer = PIXI.autoDetectRenderer(gameWidth, gameHeight, gameCanvas, true);
  var renderer = PIXI.autoDetectRenderer(gameWidth, gameHeight, rendererOptions);
  document.body.appendChild(renderer.view);
 
  var stage = new PIXI.Container();
  stage.interactive = true;
  
      var shockwave = null;
   var filter = new PIXI.filters.NoiseFilter();
  var filter2 = new PIXI.filters['ShockwaveFilter']();
      filter2.center = [0.1,0.1];
      filter2.params = [10,0.5,0.1];
 shockwave = filter2;

      
  var filter = new PIXI.filters['DotFilter']();
      
  stage.filters = [filter, filter2];


  var bunny = 0;
  var bunny2 = 0;
  var textSample = new PIXI.Text('Mumbles\n App', { font: '18px Snippet', fill: 'white', align: 'left' });

  
  PIXI.loader
      .add('Inever2','Inever2.png')
      .add('forwardbutton','forward_button.png')
       .load(onAssetsLoaded);
      
  function onAssetsLoaded(loader,resources) {

    // create some white text using the Snippet webfont

	bunny = new PIXI.Sprite(resources.Inever2.texture);
	bunny.anchor.x = 0.5;
	bunny.anchor.y = 0.5;
	bunny.position.x = 200;
	bunny.position.y = 450;
        bunny.scale.x = 0.4;
        bunny.scale.y = 0.4;
	stage.addChild(bunny);

	bunny2 = new PIXI.Sprite(resources.Inever2.texture);
	bunny2.anchor.x = 0.5;
	bunny2.anchor.y = 0.5;
	bunny2.position.x = 120;
	bunny2.position.y = 400;
        bunny2.scale.x = 0.1;
        bunny2.scale.y = 0.2;
	stage.addChild(bunny2);

	bunny3 = new PIXI.Sprite(resources.Inever2.texture);
	bunny3.anchor.x = 0.5;
	bunny3.anchor.y = 0.8;
	bunny3.position.x = 50;
	bunny3.position.y = 400;
        bunny3.basex = 330; bunny3.basey=550;
        bunny3.scale.x = 0.06;
        bunny3.scale.y = 0.06;
        bunny3.interactive = true;
        bunny3
         .on('mousedown', onDragStart)
         .on('touchstart', onDragStart)
         .on('mouseup', touchEnd) //onDragEnd
         .on('mouseupoutside', touchEnd) //onDragEnd
         .on('touchend', touchEnd) //onDragEnd
         .on('touchendoutside', touchEnd) //onDragEnd
         .on('mousemove', onDragMove)
          .on('touchmove', onDragMove)

	stage.addChild(bunny3);

	bunny4 = new PIXI.Sprite(resources.forwardbutton.texture);
	bunny4.anchor.x = 0.8;
	bunny4.anchor.y = 0.8;
	bunny4.position.x =180;
	bunny4.position.y = 20;
        bunny4.basex = 80; bunny4.basey=20;
        bunny4.scale.x = 0.5;
        bunny4.scale.y = 0.5;
        bunny4.interactive = true;
        bunny4
         .on('mouseup', touchEnd)
         .on('touchend', touchEnd)

	stage.addChild(bunny4);

        textSample.position.set(20);
	stage.addChild(textSample);


	animate();
  }

   var prevtt = 0;
   var shockx = 0.1;
      
  function animate() {
 
    requestAnimationFrame( animate );
 
//    bunny.rotation += 0.005 + Math.cos(timer/150) * 0.003;
//    bunny2.rotation += -0.02;
    var timer = +new Date;  //in millisecondds
    
    bunny.rotation = 0.02 * Math.sin(0.25 * timer/150);
    
    
//    bunny2.tint = Math.cos(timer * 0.01) * 0xFF0000 + Math.cos(timer * 0.01) * 0x00FF00 + Math.cos(timer * 0.01) * 0x0000FF;

//    bunny2.scale.x = 1 + 0.05 * Math.sin(timer * 0.01);
 //   bunny2.scale.y = 1 + 0.02 * Math.sin(timer * 0.01);

    bunny2.alpha =  0.3 + 0.3 * Math.sin(timer * 0.001);

    bunny3.position.x = bunny3.basex;
    bunny3.position.y = bunny3.basey;
//    bunny3.position.y = bunny3.basey + 40 * Math.cos(timer / 150);
    bunny3.rotation = 0 + Math.cos(0.5 * timer/150) * 0.1;
    
    
      if (shockwave) {
          var tt = timer * (107/60) % 1.0;
          if (prevtt > tt) {
//              shockwave.time = 0;
//              shockwave.center = [Math.random(), Math.random() ];
              if (shockx < 0.5) { shockx = 0.9; } else {shockx = 0.1; }
              shockwave.center = [shockx, 0.95];
          }
      }

    renderer.render(stage);
  }

 function onButtonDown()
 {
    this.isdown = true;
    this.alpha = 0;
    var gameCanvas = document.getElementById("myCanvas");
    gameCanvas.width = 20;
 }
 function onButtonUp()
 {
    this.scale.x *= 1.1;
    this.alpha = 1;
 }

function onDragStart(event)
{
  this.data = event.data;
  this.alpha = 0.5;
  this.dragging = true;
   console.log("dragstrt");
}

function onDragEnd()
{
  this.alpha = 1;
  this.dragging = false;
}

function onDragMove() {
   if (this.dragging) {
     var newPosition = this.data.getLocalPosition(this.parent);
      this.basex = newPosition.x;
      this.basey = newPosition.y;
      console.log(x + "," + y);
        textSample.setText("touch2");
  }
}
  function canvastouchmove(e) {
            if (!e) {
                var e = event;
            e.preventDefault();
            bunny4.basex  = e.targetTouches[0].pageX - can.offsetLeft;
            bunny4.basey = e.targetTouches[0].pageY - can.offsetTop;
            } 
        textSample.setText("touch");
        
   }
    function touchEnd() {
        console.log("touch");
        event.preventDefault();
        if (event.target === bunny4) {
            console.log("bunny4touch");
            nextVideo();
        } else {
            
            console.log("bunny4touch");
            nextVideo();
            
        }
    }

 // 4. The API will call this function when the video player is ready.
     function onPlayerReady(event) {
       event.target.playVideo();
     }
      
  </script>
  
  
 <script>
      // 2. This code loads the IFrame Player API code asynchronously.
      var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      tag.allowfullscreen = false;
      tag.enablejsapi = 1;
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  document.getElementById("t1").innerHTML = "one";
      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      
      
      var player;
        var vids = [ "nw5Mc5bpq-A", "a9zbC6q_EWE", "qn-X5A0gbMA", "lYqSHHlilt8","u0fk6syQ7iY" ,"LHCob76kigA" , "m5fw380Xk6g" ];
     
        var vidPtr = 0;
     
      function onYouTubeIframeAPIReady() {

          
        player = new YT.Player('player', {
          allowfullscreen: false,
          height: '100%',
          width: '100%',
          videoId: vids[vidPtr],
          style: 'border: solid 4px #37474F',
          loop: 'true',
          playsinline: 1,
          autoplay:1,
            enablejsapi:1,
         controls:0,
         webkit-playsinline: 1,
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }

      // 4. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
  document.getElementById("t1").innerHTML = "four";
        event.target.playVideo();
//         var myVideo = document.getElementsByTagName('video')[0];
//         myVideo.height = 200;
         
//        event.target.requestFullScreen;
//       event.target.mozRequestFullScreen;
//        event.target.webkitRequestFullScreen;
      }

      // 5. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
      function onPlayerStateChange(event) {
      	var playerStatus = event.data;
document.getElementById("t1").innerHTML = playerStatus + " "  + player.getCurrentTime();  
        console.log(playerStatus);
                                                                
    var color;
    var c1 = document.getElementById('myCanvas');
    
    if (playerStatus == -1) {
      color = "#37474F"; // unstarted = gray
    } else if (playerStatus == 0) {
      nextVideo();
      color = "#FFFF00"; // ended = yellow
       c1.style.zIndex="-1";
    } else if (playerStatus == 1) {
      color = "#33691E"; // playing = green
      c1.style.zIndex="3";
    } else if (playerStatus == 2) {
      color = "#DD2C00"; // paused = red
    } else if (playerStatus == 3) {
      color = "#AA00FF"; // buffering = purple
    } else if (playerStatus == 5) {
         console.log("play");       
        event.target.playVideo();
        
      color = "#FF6DOO"; // video cued = orange
    }
    if (color) {
      document.getElementById('player').style.borderColor = color;
    }
      }
      
      function stopVideo() {
        player.stopVideo();
      }
     function nextVideo() {
             vidPtr++;
        if (vidPtr >= vids.length) vidPtr = 0;
                console.log("load " + vidPtr + " " + vids[vidPtr]);

       player.loadVideoById(vids[vidPtr]);
     }
     
    </script>
    

</body>
</html>
