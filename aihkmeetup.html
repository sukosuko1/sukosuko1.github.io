<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Input text with D3</title> <!-- adapted from http://javadude.wordpress.com/2012/05/17/d3-js-with-dynamic-data/ -->
    
<script src="https://www.gstatic.com/firebasejs/4.9.1/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyAcD_Et-FTPsM-6RKGCXIFXh4mnoJJiRUU",
    authDomain: "aihkmeetup.firebaseapp.com",
    databaseURL: "https://aihkmeetup.firebaseio.com",
    projectId: "aihkmeetup",
    storageBucket: "",
    messagingSenderId: "1073849367392"
  };
  firebase.initializeApp(config);
</script>
    
   <script src="https://d3js.org/d3.v4.min.js"></script>

    <style>
        body {font-family: monospace; line-height: 160%; font-size: 18px; }
        ul {list-style: none; margin: 0; padding: 0;}
        li {display: inline-block; min-width: 80px; padding: 10px; background-color: #eee; margin: 0;}
        input {border: 1px dotted #ccc; background: white; font-family: monospace; padding: 10px 20px; font-size: 18px; margin: 20px 10px 20px 0; color: red;}
        input:focus { background-color:yellow; outline: none;}
    </style>
</head>
    <body>

        <form name="myform" onSubmit="return handleClick()">
            <input name="Submit"  type="submit" value="Add to list" >
            <input type="text" id="myVal" placeholder="Add some text&hellip;">
        </form>

        <ul></ul>
 
        <script>
 
            var dataset = [];
 
                var database = firebase.database();
            var topicList = database.ref('topics');
 
            function handleClick(event){
                let input1 = document.getElementById("myVal").value;
                console.log(document.getElementById("myVal").value)
                draw(document.getElementById("myVal").value)
                
                var newItem = topicList.push();
//                newItem.set( {input1 : 1} ) ;
                newItem.set( {"test" : 1} ) ;
                return false;
            }
 
            function draw(val){
                d3.select("body").select("ul").append("li");
                dataset.push(val);
                var p = d3.select("body").selectAll("li")
                .data(dataset)
                .text(function(d,i){return i + ": " + d;})
            }
 
            
            topicList.on('value', function(d) {
                d.forEach(function(item) {
                    console.log(item.key);
                    console.log(item.val());
                } )  
            });
            
        </script>


    </body>
</html>