if (self.CavalryLogger) { CavalryLogger.start_js(["45vNW"]); }

__d("PinnedConversationNubsActionTaken",[],(function(a,b,c,d,e,f){e.exports={TAB_CLOSED_BY_USER:0,COMMENT_ADDED:1}}),null);
__d("ChannelConnection",["Arbiter","ChannelConstants","ChannelManager","JSLogger","Run","SystemEvents","Visibility","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){__p&&__p();var g=b("JSLogger").create("channel_connection"),h=null,i=null,j=null,k=null,l=0;b("ChannelManager").startChannelManager();var m=Object.assign(new(b("Arbiter"))(),{CONNECTED:"chat-connection/connected",RECONNECTING:"chat-connection/reconnecting",SHUTDOWN:"chat-connection/shutdown",MUTE_WARNING:"chat-connection/mute",UNMUTE_WARNING:"chat-connection/unmute"});b("Run").onBeforeUnload(function(){});function n(){i&&(b("clearTimeout")(i),i=null)}function o(){n(),g.log("unmute_warning"),m.inform(m.UNMUTE_WARNING)}function p(a){n(),i=b("setTimeoutAcrossTransitions")(o,a),g.log("mute_warning",{time:a}),m.inform(m.MUTE_WARNING)}function q(){j&&(b("clearTimeout")(j),j=null)}function r(a,c){__p&&__p();q();if(a===b("ChannelConstants").ON_ENTER_STATE&&(c.nextState||c.state)==="pull"){if(k!==m.CONNECTED){g.log("connected");var d=!k;k=m.CONNECTED;l=0;m.inform(m.CONNECTED,{init:d})}}else a===b("ChannelConstants").ON_ENTER_STATE&&((c.nextState||c.state)==="ping"||!c.nextState&&c.state==="idle")?j=b("setTimeoutAcrossTransitions")(function(){var b=null;c.state==="idle"&&!c.nextState||(b=c.delay||0);g.log("reconnecting",{delay:b});m.disconnected()&&g.log("reconnecting_ui",{delay:b});k=m.RECONNECTING;c.state==="idle"&&l++;l>1?m.inform(m.RECONNECTING,b):!c.nextState&&c.state==="idle"&&r(a,c)},500):a===b("ChannelConstants").ON_SHUTDOWN&&(g.log("shutdown",{reason:c.reason}),k=m.SHUTDOWN,l=0,m.inform(m.SHUTDOWN,c.reason))}function s(){b("ChannelManager").isShutdown()?r(b("ChannelConstants").ON_SHUTDOWN,b("ChannelManager")._shutdownHint):r(b("ChannelConstants").ON_ENTER_STATE,{state:b("ChannelManager").state,nextState:b("ChannelManager").nextState,delay:0}),b("Visibility").addListener(b("Visibility").VISIBLE,m.reconnect)}b("Run").onAfterLoad(s);Object.assign(m,{disconnected:function(){return k===m.SHUTDOWN||k===m.RECONNECTING&&!i&&l>1},isShutdown:function(){return k===m.SHUTDOWN},reconnect:function(a){if(b("ChannelManager").state==="ping"||b("ChannelManager").state==="pull"||b("ChannelManager").isShutdown())return;g.log("reconnect",{now:a});m.inform(m.RECONNECTING,0);a?(h!==null&&(b("clearTimeout")(h),h=null),b("ChannelManager").enterState("ping!")):h||(h=b("setTimeoutAcrossTransitions")(function(){b("ChannelManager").enterState("ping!"),h=null},b("ChannelConstants").CHANNEL_MANUAL_RECONNECT_DEFER_MSEC));b("ChannelManager").resetDelay()},unmuteWarning:o});function t(){b("Arbiter").subscribe([b("ChannelConstants").ON_ENTER_STATE,b("ChannelConstants").ON_SHUTDOWN],r),b("Arbiter").subscribe(b("ChannelConstants").ATTEMPT_RECONNECT,function(){m.disconnected()&&m.reconnect()}),b("SystemEvents").subscribe(b("SystemEvents").TIME_TRAVEL,function(){m.reconnect(),p(b("ChannelConstants").MUTE_WARNING_TIME_MSEC)}),b("Run").onBeforeUnload(q,!1)}b("Run").onAfterLoad(t);m.mockAfterLoad=function(){s(),t()};b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,b){b.channel_connected=!m.disconnected()});e.exports=m}),3);
__d("NubController",["csx","ArbiterMixin","Dock"],(function(a,b,c,d,e,f,g){__p&&__p();function a(){}Object.assign(a.prototype,b("ArbiterMixin"),{init:function(a){this.el=a;this.nubButton=a.querySelector(".fbNubButton");this.closeButton=a.querySelector("._2dv8");b("Dock").registerNubController(a,this);this.closeButton&&this.closeButton.addEventListener("click",this.hide.bind(this));return this},buttonContentChanged:function(){this.inform("nub/button/content-changed")},flyoutContentChanged:function(){this.inform("nub/flyout/content-changed")},hide:function(){b("Dock").hide(this.el)},show:function(){b("Dock").show(this.el)}});e.exports=a}),null);
__d("BuddyListNub",["csx","cx","fbt","Arbiter","AsyncRequest","AvailableList","BootloadedComponent.react","ChannelConnection","ChatOptions","ChatSidebarActions","ChatSidebarStore","ChatSidebarVisibility","ChatVisibility","CSS","Dock","DOM","Event","intlNumUtils","JSLogger","JSResource","KeyboardShortcuts","Keys","NubController","OrderedFriendsList","Parent","PresencePrivacy","PresenceStatus","PresenceUtil","React","ReactDOM","Run","SidebarType","Style","Toggler","emptyFunction"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j,k=40,l=253,m="285px",n=b("JSLogger").create("buddylist_nub");c=babelHelpers.inherits(a,b("NubController"));j=c&&c.prototype;function a(a,c,d,e){"use strict";__p&&__p();j.constructor.call(this);j.init.call(this,a);this.root=a;this.orderedList=c;this.button=b("DOM").find(a,"a.fbNubButton");this.unreadCount=b("DOM").find(a,"span._5ayx");this.label=b("DOM").find(a,"span.label");this.body=b("DOM").scry(a,"div.fbNubFlyoutBody")[0];this.container=b("Parent").bySelector(a,"._56ox");var f=b("DOM").find(a,"div.fbNubFlyoutTitlebar");b("Toggler").createInstance(f).setSticky(!1);b("Toggler").createInstance(a).setSticky(!0);e&&b("Run").onAfterLoad(function(){this.dropdown=b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarDropdown.react").__setRef("BuddyListNub"),onToggleSidebar:function(){},sidebarType:b("SidebarType").BUDDYLIST}),e)}.bind(this));c.subscribeOnce("render",this.flyoutContentChanged.bind(this));b("Run").onAfterLoad(function(){__p&&__p();var a=b("DOM").find(f,"div._4k48");a&&b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarComposeLink.react").__setRef("BuddyListNub"),className:"_3a-4"}),a);a=b("DOM").find(this.button,"div._1us9");a&&b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarComposeLink.react").__setRef("BuddyListNub"),className:"_3a-4"}),a);a=b("DOM").find(this.button,"div._1usa");a&&b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarDropdown.react").__setRef("BuddyListNub"),onToggleSidebar:function(){},sidebarType:b("SidebarType").BUDDYLIST_NUB}),a);a=b("DOM").find(f,"div._3gl7");a&&b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarGroupCreateButtonReactComponent").__setRef("BuddyListNub")}),a);a=b("DOM").find(this.button,"div._3gll");a&&b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("ChatSidebarGroupCreateButtonReactComponent").__setRef("BuddyListNub"),className:"newGCF"}),a)}.bind(this));c.setScrollContainer(this.body);b("AvailableList").subscribe("buddylist/availability-changed",this._updateCount.bind(this));b("Arbiter").subscribe("chat/connect",function(){return this._handleConnect(!0)}.bind(this));b("Arbiter").subscribe("chat/option-changed",function(a,b){b.name=="hide_groups"?this.onResize():b.name==="hide_buddylist"&&(b.value?this.hide():this.show())}.bind(this));b("ChannelConnection").subscribe(b("ChannelConnection").CONNECTED,function(){return this._updateView()}.bind(this));b("ChannelConnection").subscribe(b("ChannelConnection").SHUTDOWN,function(){return this._updateView()}.bind(this));b("ChannelConnection").subscribe(b("ChannelConnection").RECONNECTING,function(){return this._updateView()}.bind(this));b("ChannelConnection").subscribe([b("ChannelConnection").MUTE_WARNING,b("ChannelConnection").UNMUTE_WARNING],function(){return this._updateView()}.bind(this));this.subscribe("show",this.onShow.bind(this));this.subscribe("hide",this.onHide.bind(this));this.subscribe("resize",this.onResize.bind(this));b("Event").listen(a,"keydown",this._onKeyDown.bind(this));b("Event").listen(this.button,"click",this.onButtonClick.bind(this));b("KeyboardShortcuts").register("q",function(event){this._isOpen||(this.onButtonClick(),this.show()),event.prevent()}.bind(this),{persistOnTransition:!0,shortcutInfo:{displayKeys:["q"],description:i._("Search chat contacts")}});b("Arbiter").subscribe("minisidebar/show",this.hide.bind(this));b("Arbiter").subscribe("sidebar/visibility",function(a,b){b?this.hide():this._onSidebarHide()}.bind(this));b("Style").set(this.body,"min-height",m);b("Arbiter").subscribe("sidebar/typeahead/active",function(a,c){c?(this._typeaheadActive=!0,b("CSS").hide(this.body.parentNode),this.orderedList.hide(),this.onResize()):(this._typeaheadActive=!1,this.onResize(),b("CSS").show(this.body.parentNode),this.orderedList.show())}.bind(this));b("OrderedFriendsList").getList(function(a){b("ChatSidebarStore").isEnabled()&&b("ChatSidebarStore").getVisibleType()===b("SidebarType").BUDDYLIST&&!b("ChatOptions").getSetting("hide_buddylist")&&!b("ChannelConnection").disconnected()&&!b("PresencePrivacy").isUserOffline()&&a.length>0&&this.show(),b("Event").listen(f,"click",function(a){b("CSS").matchesSelector(a.target,".titlebarTextWrapper")&&this._syncHideBuddylist(!0)}.bind(this)),this._updateView(),n.log("buddylist_initialized")}.bind(this))}a.prototype._handleVisibilityChange=function(){"use strict";this._updateView(),b("ChatVisibility").isOnline()||this.hide()};a.prototype._updateView=function(a){"use strict";__p&&__p();var c;if(!b("ChatVisibility").isOnline())a=i._("{Chat} (Off)",[i._param("Chat",i._("Chat"))]);else if(b("ChannelConnection").disconnected())a=i._("{Chat} (Disconnected)",[i._param("Chat",i._("Chat"))]);else{var d=b("PresenceStatus").getOnlineCount();if(d){var e=b("DOM").create("span",{className:"count"},"("+b("intlNumUtils").formatNumberWithThousandDelimiters(d)+")");a=i._({"*":"{Chat} {number-available}"},[i._param("Chat",i._("Chat")),i._param("number-available",e,[0,d])])}else a=i._("Chat"),c=!0}this._setPresenceIcon();this._setUnread();this._setLabel(a,c);this.buttonContentChanged()};a.prototype._setPresenceIcon=function(){"use strict";b("CSS").conditionClass(this.root,"offline",!b("ChatVisibility").isOnline()||b("ChannelConnection").disconnected())};a.prototype.onButtonClick=function(){"use strict";if(!b("ChatSidebarStore").isInitialized())return!0;b("ChatSidebarVisibility").shouldShowSidebarIgnoreEnabled(null,function(a,c){c=b("ChatSidebarStore").isEnabled();!c&&a?b("ChatSidebarActions").enable(b("SidebarType").SIDEBAR):b("ChatSidebarActions").show(c&&a?b("SidebarType").SIDEBAR:b("SidebarType").BUDDYLIST)})};a.prototype.onHide=function(){"use strict";this._isOpen=!1,this._buddyListRenderSubscription&&(this.orderedList.unsubscribe(this._buddyListRenderSubscription),this._buddyListRenderSubscription=null),this._hideBuddyList(),b("Arbiter").inform("buddylist/hide")};a.prototype._onKeyDown=function(event){"use strict";var a=b("Event").getKeyCode(event);if(a===b("Keys").ESC&&!b("CSS").hasClass(this.root,"menuOpened")){this.hide();return!1}else a==b("Keys").RETURN&&b("ChatSidebarVisibility").shouldShowSidebarIgnoreEnabled(null,function(a,c){b("ChatSidebarActions").enable(a?b("SidebarType").SIDEBAR:b("SidebarType").BUDDYLIST)})};a.prototype._onSidebarHide=function(event){"use strict";b("OrderedFriendsList").getList(function(a){b("ChatSidebarStore").isEnabled()&&!b("ChatOptions").getSetting("hide_buddylist")&&!b("ChannelConnection").disconnected()&&!b("PresencePrivacy").isUserOffline()&&a.lenth>0?this.show():this.hide()}.bind(this))};a.prototype.onResize=function(){"use strict";var a=this._typeaheadActive?b("Dock").getMaxFlyoutHeight(this.root)-60:l;b("Arbiter").inform("buddyList/resized",a,b("Arbiter").BEHAVIOR_PERSISTENT);this._typeaheadActive?b("Style").set(this.body,"max-height","none"):b("Style").set(this.body,"max-height",m);a=Math.max(250,a);a=Math.floor(a/k);this.orderedList.setNumTopFriends(a,!1,b("SidebarType").BUDDYLIST)};a.prototype._showBuddyList=function(){"use strict";this._buddyListRenderSubscription=this.orderedList.subscribe("render",function(){b("Style").get(this.body,"height")!=m&&b("Style").set(this.body,"height",m)}.bind(this)),this.orderedList.show(),n.bump("buddylist_show")};a.prototype._hideBuddyList=function(){"use strict";this.orderedList.hide(),n.bump("buddylist_hide")};a.prototype.onShow=function(){"use strict";this._isOpen=!0,b("ChannelConnection").disconnected()?(b("ChannelConnection").reconnect(),this._showBuddyList()):b("ChatVisibility").goOnline(this._showBuddyList.bind(this)),this._syncHideBuddylist(!1)};a.prototype._setLabel=function(a,c){"use strict";var d=this.label.textContent||this.label.innerText;if(d!==a){d=this.label.cloneNode(!0);b("DOM").setContent(d,a);b("DOM").replace(this.label,d);this.label=d}this.throbber&&b("CSS").conditionShow(this.throbber,!!c)};a.prototype._setUnread=function(a){"use strict";b("CSS").conditionShow(this.unreadCount,!!a)};a.prototype._updateCount=function(){"use strict";this._updateView()};a.prototype._syncHideBuddylist=function(a){"use strict";b("ChatOptions").setSetting("hide_buddylist",a,"buddylist"),new(b("AsyncRequest"))("/ajax/chat/settings.php").setHandler(b("emptyFunction")).setErrorHandler(b("emptyFunction")).setData({hide_buddylist:a,window_id:b("PresenceUtil").getSessionID()}).setAllowCrossPageTransition(!0).send()};b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,c){c.buddylist_visible=b("ChatSidebarStore").getVisibleType()===b("SidebarType").BUDDYLIST});e.exports=a}),null);
__d("ChatUnreadCount",["ChatConfig","ChatDispatcher","ChatUnreadCountActionTypes","MercuryIDs","MercurySingletonProvider","MercuryThreadInformer","MercuryThreads","MercuryUnreadState"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};function a(a){this.$1=a,this.$2=b("MercuryThreadInformer").getForFBID(a),this.$3=b("MercuryThreads").getForFBID(a),this.$4=new Map(),this.$5=b("MercuryUnreadState").getForFBID(a),this.setupSubscriptions()}a.prototype.getUnreadCountForUID=function(a){__p&&__p();if(!a)return null;var c=b("MercuryIDs").getThreadIDFromUserID(a);if(!this.$5.getIsThreadUnread(c)&&!b("ChatConfig").get("unread_count_fix")){this.$4["delete"](a);return 0}c=this.$3.getOrFetch(c);c=c&&c.unread_count;!c&&b("ChatConfig").get("unread_count_fix")?this.$4["delete"](a):this.$4.set(a,c);return c};a.prototype.setupSubscriptions=function(){__p&&__p();this.$2.subscribe("threads-updated",function(a,c){a=Object.keys(c).some(function(a){a=b("MercuryIDs").getUserIDFromThreadID(a);if(!a)return!1;var c=this.getUnreadCountForUID(a);a=this.$4.get(a)||0;return c!==a}.bind(this));a&&b("ChatDispatcher").dispatch({type:b("ChatUnreadCountActionTypes").COUNT_UPDATED})}.bind(this)),this.$2.subscribe("unread-updated",function(){return b("ChatDispatcher").dispatch({type:b("ChatUnreadCountActionTypes").COUNT_UPDATED})})};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("NotificationBeeperConst",["keyMirror"],(function(a,b,c,d,e,f){a={IDLE_DELAY:1e4,ACTIVE_DELAY_LONG:4e3,FADE_OUT_LENGTH:1500,BeepStates:b("keyMirror")({PENDING:!0,RENDERED:!0,READY_TO_HIDE:!0,FADING_OUT:!0})};e.exports=a}),null);
__d("NotificationBeeperItemCloseButton.react",["cx","fbt","React","XUIAbstractGlyphButton.react"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){"use strict";var a=h._("Close");return b("React").createElement(b("XUIAbstractGlyphButton.react"),babelHelpers["extends"]({},this.props,{className:"_3soc",title:a,label:a,labelIsHidden:!0}))};function a(){"use strict";i.apply(this,arguments)}e.exports=a}),null);
__d("NotificationURI",["BusinessURI.brands","URI","VideoPermalinkURI","isFacebookURI"],(function(a,b,c,d,e,f){__p&&__p();a={localize:function(a){try{a=b("BusinessURI.brands")(a)}catch(b){return a.toString()}var c=a.getSubdomain();return a.getUnqualifiedURI().getQualifiedURI().setSubdomain(c).toString()},snowliftable:function(a){if(!a)return!1;a=new(b("URI"))(a);var c=a.getQueryData();return b("isFacebookURI")(a)&&(b("VideoPermalinkURI").isValid(a)||"fbid"in c)},isVaultSetURI:function(a){return this._areEquals(a,"/ajax/vault/sharer_preview.php")},isAlbumDraftRecoveryDialogURI:function(a){return this._areEquals(a,"/ajax/photos/upload/overlay/")},isQuicksilverURI:function(a){return this._areEquals(a,"/games/quicksilver/spotlight/")},isDirectURI:function(a){return this._startsWith(a,"/direct/")},isIGAccountCreationURI:function(a){return this._areEquals(a,"/ads/growth/aymt/instagram/account-creation-dialog/")},_areEquals:function(a,c){if(!a)return!1;a=new(b("URI"))(a);return b("isFacebookURI")(a)&&a.getPath()===c},_startsWith:function(a,c){if(!a)return!1;a=new(b("URI"))(a);return b("isFacebookURI")(a)&&a.getPath().startsWith(c)}};e.exports=a}),null);
__d("XLiveVideoLoadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/live/video/load/",{video_id:{type:"FBID",required:!0}})}),null);
__d("NotificationListRendererUtils",["AsyncRequest","Bootloader","NotificationURI","PageTransitions","URI","VideoChainingCaller","XLiveVideoLoadController","idx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(event,a){b("Bootloader").loadModules(["FBStoriesLiveNotificationHandler"],function(b){b.renderLiveStory(a)},"NotificationListRendererUtils")}function h(event,a,c){b("Bootloader").loadModules(["TahoeController"],function(d){var e=b("NotificationURI").localize(new(b("URI"))(c.url)),f=a.video_channel_caller;d.openFromVideoLink(new(b("URI"))(e),{channelID:a.video_channel_id,caller:f?(d=b("VideoChainingCaller"))!=null?d[f]:d:null})},"NotificationListRendererUtils")}var i={openNotification:function(event,a){__p&&__p();var c=a.renderer_data;if(c==null)return;if(!i.isStoryOnlyLiveVideoNotification(a)&&(event.metaKey||event.ctrlKey||event.button===1))return;if(c.__typename==="LiveVideoNotificationRendererData"){event.preventDefault();c=b("XLiveVideoLoadController").getURIBuilder().setFBID("video_id",c.video_id).getURI();c=new(b("AsyncRequest"))(c).setHandler(function(c){c.payload?i.openNotificationInSurface(event,a):b("PageTransitions").go(a.url)});c.send()}},openNotificationInSurface:function(event,a){var b=a.renderer_data;if(b==null)return;b.bucket_data?g(event,b):b.can_render_in_tahoe&&h(event,b,a)},isStoryOnlyLiveVideoNotification:function(a){a=a.renderer_data;return a==null?!1:a.__typename==="LiveVideoNotificationRendererData"&&!!a.bucket_data}};e.exports=i}),null);
__d("RelationshipDelightTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:RelationshipDelightLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:RelationshipDelightLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:RelationshipDelightLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAlertID=function(a){this.$1.alert_id=a;return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setMetadata=function(a){this.$1.metadata=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={alert_id:!0,event:!0,metadata:!0,vc:!0};e.exports=a}),null);
__d("RelationshipDelightUtils",["NotificationRelationshipDelightsConfig","QE2Logger","RelationshipDelightTypedLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={};function h(a){a=a.eligible_buckets;return!!a&&a.indexOf("SO_NOTIFICATIONS")!==-1}function i(){b("QE2Logger").logExposureForUser(b("NotificationRelationshipDelightsConfig").universeName)}function a(a){var c=b("NotificationRelationshipDelightsConfig").shouldDecorateNotificationWithHearts,d=b("NotificationRelationshipDelightsConfig").shouldLogExposureForNotification;if(h(a)===!1)return!1;d&&i();return c===!0}function j(a,event,c){var d=event+"-"+a;if(g[d])return;g[d]=!0;d=new(b("RelationshipDelightTypedLogger"))().setEvent(event).setAlertID(a);c&&d.setMetadata(JSON.stringify(c));d.log()}c={shouldHeartBadge:function(a){var c=b("NotificationRelationshipDelightsConfig").shouldDecorateBadgeWithHearts,d=b("NotificationRelationshipDelightsConfig").shouldLogExposureForBadge;if(h(a)===!1)return!1;d&&i();return c===!0},shouldHeartBeeper:a,shouldHeartNotification:a,logNotificationAnimation:function(a,b,c){j(a,"notification_animated",{animation:b,rowIndex:c})},logBeeperAnimation:function(a){j(a,"beeper_animated")},logBadgeAnimation:function(a){j(a,"badge_animated")}};e.exports=c}),null);
__d("NotificationBeeperItemContents.react",["cx","Animation","AsyncRequest","BootloadedComponent.react","Bootloader","FBProfilePhotoShadow.react","Image.react","ImageBlock.react","JSResource","NotificationBeeperItemCloseButton.react","NotificationInterpolator","NotificationListRendererUtils","NotificationURI","NotificationUserActions","React","ReactDOM","RelationshipDelightUtils","TextWithEntities.react","Timestamp.react","URI"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.isLiveVideo=null,this.$2=function(a){__p&&__p();this.$1();this.props.onHide();if(a.button===1||a.altKey||a.ctrlKey||a.metaKey||a.shiftKey)return;var c=this.props.notification;b("NotificationListRendererUtils").openNotification(a,c);if(a.isDefaultPrevented()===!0)return;var d=c.primerAttributes;if(d&&(d.rel==="async"||d.rel==="async-post")){var e=new(b("AsyncRequest"))(d.ajaxify||c.url);d.rel==="async-post"&&e.setMethod("POST");e.send();a.preventDefault()}else d&&d.rel==="theater"?(a.persist(),b("Bootloader").loadModules(["PhotoSnowlift"],function(b){b.bootstrap(d.ajaxify||c.url,a.currentTarget)},"NotificationBeeperItemContents.react"),a.preventDefault()):d&&(d.rel==="dialog"||d.rel==="dialog-post")&&(b("Bootloader").loadModules(["AsyncDialog"],function(b){b.bootstrap(d.ajaxify||c.url,a.currentTarget,"dialog")},"NotificationBeeperItemContents.react"),a.preventDefault())}.bind(this),this.$3=function(){this.$1(),this.props.onHide()}.bind(this),c}a.prototype.$1=function(){"use strict";b("NotificationUserActions").markNotificationsAsRead([this.props.notification.alert_id])};a.prototype.$4=function(){"use strict";new(b("Animation"))(b("ReactDOM").findDOMNode(this.refs.inner)).from("opacity","0").to("opacity","1").duration(200).go()};a.prototype.$5=function(){"use strict";var a=this.$6();a=JSON.parse(a);return a.content_id};a.prototype.$7=function(){"use strict";if(this.isLiveVideo===null){var a=this.$6();this.isLiveVideo=a.indexOf("live_video")!==-1}return!!this.isLiveVideo};a.prototype.$6=function(){"use strict";return this.props.notification.tracking||"{}"};a.prototype.$8=function(){"use strict";var a=this.props.notification,c=b("RelationshipDelightUtils").shouldHeartBeeper(a);if(!c)return null;b("RelationshipDelightUtils").logBeeperAnimation(a.alert_id);return b("React").createElement("div",{className:"_5_xp"},b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("RelationshipDelightsActorAnimation.react").__setRef("NotificationBeeperItemContents.react")}))};a.prototype.componentDidMount=function(){"use strict";this.props.onReadyToHide(this.props.notification.alert_id),this.$7()&&b("Bootloader").loadModules(["VideoPlayerMetaData","PhotoSnowliftVideoNode"],function(a,b){b=this.$5();b&&a.genVideoData(b)}.bind(this),"NotificationBeeperItemContents.react")};a.prototype.componentDidUpdate=function(a){"use strict";(a.notification.alert_id!==this.props.notification.alert_id||a.notification.creation_time!==this.props.notification.creation_time)&&(this.$4(),this.props.onReadyToHide(this.props.notification.alert_id))};a.prototype.render=function(){"use strict";var a=this.props.notification,c=a.thumbnail?a.thumbnail.uri:null,d=a.icon?a.icon.uri:null,e=b("NotificationURI").localize(new(b("URI"))(a.url));return b("React").createElement("div",{ref:"inner",className:this.props.className},b("React").createElement(b("NotificationBeeperItemCloseButton.react"),{onClick:this.$3}),b("React").createElement("a",{href:e,onClick:this.$2,className:"_3soi"},b("React").createElement(b("ImageBlock.react"),{className:"_3soj",spacing:"medium"},b("React").createElement(b("FBProfilePhotoShadow.react"),{className:"_2yt7"},b("React").createElement(b("Image.react"),{src:c,className:"_3sok"+(c?"":" hidden_elem")})),b("React").createElement("div",{className:"_3sol"},b("React").createElement(b("TextWithEntities.react"),{renderEmoticons:!0,renderEmoji:!0,interpolator:b("NotificationInterpolator"),ranges:a.title.ranges,aggregatedranges:a.title.aggregated_ranges,text:a.title.text}),b("React").createElement(b("ImageBlock.react"),{className:"_3som"},b("React").createElement(b("Image.react"),{className:"_1x8t"+(d?"":" hidden_elem"),src:d}),b("React").createElement(b("Timestamp.react"),{time:a.timestamp.time,text:a.timestamp.text,verbose:a.timestamp.verbose})))),this.$8()))};e.exports=a}),null);
__d("NotificationBeeperItem.react",["cx","CSSFade","NotificationBeeperConst","NotificationBeeperItemContents.react","NotificationBeeperItemRenderersList","React","ReactDOM","Style","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("NotificationBeeperConst").FADE_OUT_LENGTH;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={encounteredException:!1,fadedIn:!1,hidden:!1},this.$3=function(){this.setState({hidden:!0})}.bind(this),b}a.prototype.componentDidCatch=function(){"use strict";this.props.onReadyToHide(this.props.notification.alert_id),this.setState(function(a){return babelHelpers["extends"]({},a,{encounteredException:!0})})};a.prototype.componentDidMount=function(){"use strict";b("setTimeoutAcrossTransitions")(function(){this.setState({fadedIn:!0})}.bind(this),50),this.props.onInserted(this.props.notification.alert_id)};a.prototype.componentWillUnmount=function(){"use strict";this.$1&&this.$1.cancel()};a.prototype.render=function(){"use strict";if(this.state.encounteredException)return null;var a=this.props.notification,c=a.renderer_data;a=a.tracking;c=this.$4(c);return b("React").createElement("li",{className:this.state.hidden?"hidden_elem":"",ref:function(a){return this.$2=a}.bind(this),"data-gt":a},b("React").createElement(c,{className:"_3sod"+(this.state.fadedIn?" _3soe":""),notification:this.props.notification,onHide:this.$3,onReadyToHide:this.props.onReadyToHide,onPreventHide:this.props.onPreventHide}))};a.prototype.componentDidUpdate=function(a,c,d){"use strict";if(!this.$2)return;a=b("ReactDOM").findDOMNode(this.$2);if(!a)return;this.props.fadingOut?(this.$1=b("CSSFade").hide(a,{callback:this.$3,duration:i}),a.style.transitionDuration="0ms"):(this.$1&&(this.$1.cancel(),this.$1=undefined),b("Style").set(a,"opacity","1"))};a.prototype.$4=function(a){"use strict";return a&&a.__typename==="LiveVideoNotificationRendererData"&&a.video_id==null?b("NotificationBeeperItemContents.react"):b("NotificationBeeperItemRenderersList")[a&&a.__typename]||b("NotificationBeeperItemContents.react")};e.exports=a}),null);
__d("NotificationImpressions",["AsyncSignal","NotificationTokens","URI"],(function(a,b,c,d,e,f){var g="/ajax/notifications/impression.php";function a(a,c){var d={ref:c};b("NotificationTokens").untokenizeIDs(a).forEach(function(a,b){d["alert_ids["+b+"]"]=a});new(b("AsyncSignal"))(new(b("URI"))(g).getQualifiedURI().toString(),d).send()}e.exports={log:a}}),null);
__d("NotificationSound",["Sound"],(function(a,b,c,d,e,f){__p&&__p();var g=5e3;b("Sound").init(["audio/mpeg"]);function a(a){this._soundPath=a,this._lastPlayed=0}Object.assign(a.prototype,{play:function(a){if(!this._soundPath)return;var c=Date.now();if(c-this._lastPlayed<g)return;this._lastPlayed=c;b("Sound").playOnlyIfImmediate(this._soundPath,a)}});e.exports=a}),null);
__d("NotificationBeeper.react",["cx","Arbiter","ChannelConstants","FacebookWebNotificationsSubscription","NotificationBeeperConst","NotificationBeeperItem.react","NotificationConstants","NotificationImpressions","NotificationSound","NotificationUpdates","NotificationUserActions","NotifTestIDs","React","SubscriptionsHandler","clearTimeout","setTimeoutAcrossTransitions","shield"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("NotificationBeeperConst").ACTIVE_DELAY_LONG,j=b("NotificationBeeperConst").BeepStates,k=b("NotificationBeeperConst").FADE_OUT_LENGTH,l=b("NotificationBeeperConst").IDLE_DELAY,m="beeper";c=b("NotificationConstants").PayloadSourceType;var n=c.CLIENT,o=c.OTHER_APPLICATION;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={beeps:{},fading:!1,hovering:!1,soundEnabled:this.props.soundEnabled},this.onMouseEnter=function(){this.$2&&b("clearTimeout")(this.$2);var a=[],c=this.state.beeps;Object.keys(c).forEach(function(b){c[b].state!=j.PENDING?a.push(b):c[b].state=j.RENDERED});b("NotificationUserActions").markNotificationsAsSeen(a);this.setState({hovering:!0,fading:!1,beeps:c})}.bind(this),this.onMouseLeave=function(){this.$5(i),this.setState({hovering:!1})}.bind(this),this.$6=function(a){this.state.hovering||this.$5(),this.state.soundEnabled&&this.state.beeps[a].shouldPlaySound&&(this.$3||(this.$3=new(b("NotificationSound"))(this.props.soundPath)),this.$3.play(a)),this.props.shouldLogImpressions&&b("NotificationImpressions").log([a],m)}.bind(this),this.onReadyToHide=function(a,b){this.setState(function(b){var c=babelHelpers["extends"]({},b.beeps);c[a]=babelHelpers["extends"]({},c[a],{state:j.READY_TO_HIDE});return babelHelpers["extends"]({},b,{beeps:c})}),this.$2||this.$5(b)}.bind(this),this.$8=function(a){this.setState(function(b){var c=babelHelpers["extends"]({},b.beeps);c[a]=babelHelpers["extends"]({},c[a],{state:j.RENDERED});return babelHelpers["extends"]({},b,{beeps:c})})}.bind(this),this.$7=function(){this.$2=null,this.setState(function(a){var b=babelHelpers["extends"]({},a.beeps);Object.keys(b).forEach(function(a){b[a].state==j.READY_TO_HIDE&&(b[a]=babelHelpers["extends"]({},b[a],{state:j.FADING_OUT}))});return babelHelpers["extends"]({},a,{beeps:b,fading:!0})}),b("setTimeoutAcrossTransitions")(b("shield")(this.$9,this),k)}.bind(this),this.$9=function(){__p&&__p();if(!this.state.fading)return;this.setState(function(a){var b=babelHelpers["extends"]({},a.beeps);Object.keys(b).forEach(function(a){b[a].state==j.FADING_OUT&&delete b[a]});return babelHelpers["extends"]({},a,{beeps:b,fading:!1})});b("setTimeoutAcrossTransitions")(function(){this.setState(function(a){var b=babelHelpers["extends"]({},a.beeps);Object.keys(b).forEach(function(a){b[a].state==j.PENDING&&(b[a]=babelHelpers["extends"]({},b[a],{state:j.RENDERED}))});return babelHelpers["extends"]({},a,{beeps:b})})}.bind(this))}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){"use strict";__p&&__p();var a=new(b("SubscriptionsHandler"))();a.addSubscriptions(b("NotificationUpdates").subscribe("update-notifications",function(a,b){if(b.payloadsource===o||b.payloadsource===n){a=b.nodes;a&&a.length&&this.handleBeepChanges(this.$4(a))}}.bind(this)),b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("notif_sound_pref_changed"),function(a,b){this.setState({soundEnabled:b.obj.enabled})}.bind(this)));a.addSubscriptions(b("FacebookWebNotificationsSubscription").subscribe({event:"NEW_BEEPER",callback:function(a){var b=a.notification;a=a.should_play_sound;if(b!==null){var c;this.handleBeepChanges((c={},c[b.alert_id]={notification:b,shouldPlaySound:a},c))}}.bind(this)}));this.$1=a;b("Arbiter").inform("NotificationBeeper/mounted",null,b("Arbiter").BEHAVIOR_PERSISTENT)};a.prototype.componentWillUnmount=function(){"use strict";this.$1&&this.$1.release(),this.$1=null};a.prototype.$5=function(a){"use strict";this.$2&&b("clearTimeout")(this.$2),this.$2=b("setTimeoutAcrossTransitions")(b("shield")(this.$7,this),a==null?l:a)};a.prototype.handleBeepChanges=function(a){"use strict";var b=this.state.fading?j.PENDING:j.RENDERED,c=!1,d=babelHelpers["extends"]({},this.state.beeps);Object.keys(a).reverse().forEach(function(e){var f=a[e],g=d[e];(!g||g.notification.alert_id!==f.notification.alert_id||g.notification.creation_time!==f.notification.creation_time)&&(g&&(c=!0,delete d[e]),d[e]=babelHelpers["extends"]({},f,{state:b}))});c&&this.$5();this.setState({beeps:d})};a.prototype.render=function(){"use strict";__p&&__p();var a=this.state.beeps,c=[];Object.keys(a).reverse().forEach(function(d){var e=a[d];if(e.state==j.PENDING)return;c.push(b("React").createElement(b("NotificationBeeperItem.react"),{key:d,fadingOut:this.state.fading&&e.state==j.FADING_OUT,notification:e.notification,onInserted:this.$6,onReadyToHide:this.onReadyToHide,onPreventHide:this.$8}))}.bind(this),this);var d=c.length>0;d=(d?"":"hidden_elem")+" _50d1";return b("React").createElement("ul",{ref:"container",className:d,"data-gt":this.props.tracking,"data-testid":b("NotifTestIDs").BEEPER_LIST,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},c)};a.prototype.$4=function(a){"use strict";return a.reduce(function(a,b){a[b.alert_id]={notification:b,shouldPlaySound:!1};return a},{})};e.exports=a}),null);
__d("NotificationBeeperContainer",["NotificationBeeper.react","React","ReactDOM"],(function(a,b,c,d,e,f){a={renderBeeper:function(a,c){b("ReactDOM").render(b("React").createElement(b("NotificationBeeper.react"),a),c)}};e.exports=a}),null);
__d("LiveVideoBeeperItemContents.react",["BootloadOnRender.react","JSResource","LazyComponent.react","React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){return b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("LiveVideoBeeperItemContentsImpl.react").__setRef("LiveVideoBeeperItemContents.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),babelHelpers["extends"]({},this.props,{ref:"itemContents"}))})};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("ConversationNubAddTabSource",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({NOTIFICATION:"notification",PAGE_REFRESH:"page_refresh",USER_PIN:"user_pin",UNSEEN_NOTIFICATION:"unseen_notification",UNKNOWN:"unknown"})}),null);
__d("ConversationNubTabStateListStorage",[],(function(a,b,c,d,e,f){"use strict";function a(){this.$1=[]}a.prototype.modify=function(a){this.$1=a(this.$1)};a.prototype.getData=function(){return this.$1};e.exports=a}),null);
__d("differenceSets",["filterSet"],(function(a,b,c,d,e,f){"use strict";function a(a){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return b("filterSet")(a,function(a){return!d.some(function(b){return b.has(a)})})}e.exports=a}),null);
__d("ConversationNubTabStateList",["invariant","ConversationNubTabStateListStorage","differenceSets"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(){this.$2=new Set(),this.$1=new(b("ConversationNubTabStateListStorage"))()}a.prototype.modifyTabState=function(a,b){this.modifyTabs(function(c){var d=c.findIndex(function(b){return b.tabID===a});d!==-1||g(0);b(c[d]);return c})};a.prototype.$3=function(a){return new Set(a.map(function(a){return a.tabID}))};a.prototype.modifyTabs=function(a){try{this.$1.modify(function(c){var d=this.$3(c);c=a(c);var e=this.$3(c);this.$2=b("differenceSets")(d,e);return c}.bind(this))}finally{this.$2=new Set()}};a.prototype.getTabs=function(){return this.$1.getData()};a.prototype.getTabState=function(a){a=this.getTabStateIfExists(a);a||g(0);return a};a.prototype.getTabStateIfExists=function(a){return this.getTabs().find(function(b){return b.tabID===a})};a.prototype.push=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.modifyTabs(function(a){b.forEach(function(b){a.find(function(a){return a.tabID===b.tabID})?g(0):a.push(b)});return a})};a.prototype.remove=function(a){this.modifyTabs(function(b){var c=b.findIndex(function(b){return b.tabID===a});c!==-1&&b.splice(c,1);return b})};e.exports=a}),null);
__d("ConversationNubTabState",["invariant","ConversationNubTabStateList"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=12;function a(){this.$1=Object.create(null),this.$2=new(b("ConversationNubTabStateList"))(),this.$3=Infinity}a.prototype.anyTabHasFocus=function(){return this.getUnsortedLoadedTabs().some(function(a){return a.getIsFocused()})};a.prototype.anyTabHasText=function(){return this.getUnsortedLoadedTabs().some(function(a){return a.getHasText()})};a.prototype.getTabState=function(a){return this.$2.getTabState(a)};a.prototype.getTabStateIfExists=function(a){return this.$2.getTabStateIfExists(a)};a.prototype.getUnloadedTabs=function(){var a=this.$2.getTabs().filter(function(a){return!this.getLoadedTab(a.tabID)}.bind(this));return a};a.prototype.setMaxDockTabs=function(a){this.$3=a};a.prototype.getNumDockTabs=function(){var a=this.$3,b=this.getTotalTabCount();return Math.min(a,b)};a.prototype.getNumMenuTabs=function(){return this.getTotalTabCount()-this.getNumDockTabs()};a.prototype.addTabState=function(a){this.$2.push(a)};a.prototype.addLoadedTab=function(a,b){var c=this.getTabState(a);if(!c)return;c=this.getLoadedTab(a);if(c)return;this.$1[a]=b;this.$4()};a.prototype.getLoadedTab=function(a){return this.$1[a]};a.prototype.getLoadedTabByFeedbackTarget=function(a){return this.getLoadedTabs().find(function(b){return b.getPersistentState().ftID===a})};a.prototype.isTabInDock=function(a){a=this.getLoadedTab(a);if(!a)return!1;a=this.$5(a);return 0<=a&&a<this.getNumDockTabs()};a.prototype.clearTabNotifications=function(a){this.$2.modifyTabState(a,function(a){a.unseenCommentsSinceLastCleared={},a.hasFakeInitBadge=!1,a.badgeCount=0,a.isBlinkingUnread=!1})};a.prototype.deleteTab=function(a){var b=this.getLoadedTab(a);b&&(delete this.$1[a],b.destroy());this.$2.remove(a);return Boolean(b)};a.prototype.deleteAllTabs=function(){this.getUnsortedLoadedTabs().forEach(function(a){return this.deleteTab(a.getTabID())}.bind(this))};a.prototype.modifyTabState=function(a,b){return this.$2.modifyTabState(a,b)};a.prototype.moveTabToDockLeft=function(a){__p&&__p();var b=this.getLoadedTab(a);if(!b)return;this.$2.modifyTabs(function(c){__p&&__p();var d=c.findIndex(function(b){return b.tabID===a});d!==-1||g(0);var e=c[d],f=this.$5(b),h=this.getLoadedTabs().length,i=this.getNumDockTabs();if(f<0||h===0)return c;else if(i===0){f!==0&&(c.splice(d,1),c.unshift(e));return c}h=i-1;if(f===h)return c;c.splice(d,1);f<h&&(h-=1);i=this.getLoadedTabs()[h];var j=this.getTabState(i.getTabID());j||g(0);d=c.findIndex(function(a){return a.tabID===j.tabID});c.splice(d,0,e);return c}.bind(this))};a.prototype.getLoadedTabs=function(){var a=this.$2.getTabs().map(function(a){return this.getLoadedTab(a.tabID)}.bind(this)).filter(Boolean);return a};a.prototype.getUnsortedLoadedTabs=function(){var a=Object.values(this.$1);return a};a.prototype.getTotalTabCount=function(){return this.getUnsortedLoadedTabs().length};a.prototype.getTabsForDockOldestFirst=function(){return this.getLoadedTabs().slice(0,this.getNumDockTabs())};a.prototype.getTabsForDockNewestFirst=function(){return this.getTabsForDockOldestFirst().slice().reverse()};a.prototype.getTabsForMenuOldestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs())};a.prototype.getTabsForMenuNewestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs()).reverse()};a.prototype.$4=function(){var a=this.getLoadedTabs().length;if(a>h){a=a-h;a=this.getTabsForMenuOldestFirst().slice(0,a);a.map(function(a){return a.getTabID()}).forEach(function(a){return this.deleteTab(a)}.bind(this))}};a.prototype.$5=function(a){return this.getLoadedTabs().indexOf(a)};e.exports=new a()}),null);
__d("ConversationNubAddCommentSubscription",["Arbiter","ConversationNubTabState","UFIUIEvents"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){return b("Arbiter").subscribe(b("UFIUIEvents").Comment,function(c,d){c=d.ft_id;d=d.form;if(!c||!d)return;var e=b("ConversationNubTabState").getLoadedTabByFeedbackTarget(c);e&&e.isFormForThisUFI(d)&&a(e,c)})}e.exports={subscribe:a}}),null);
__d("ConversationNub",["csx","cx","Arbiter","ConversationNubHeader","ConversationNubTabState","ConversationNubTabsUpdateEventController","ConversationNubUtils","CSS","DOM","EventListener","NotificationUserActions","SubscriptionsHandler","UFIComposerIsTypingStore","URI","containsNode","debounce","guid"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("ConversationNubTabsUpdateEventController").minimizeAndInformTabUpdate,j=b("ConversationNubTabsUpdateEventController").popOutAndInformTabUpdate,k=b("ConversationNubTabState"),l=10,m=500,n=100;a.createDefaultState=function(a,c,d,e,f,g){return{tabID:a,permalinkURI:c?new(b("URI"))(c):null,ftID:d,notifAlertID:e,notificationType:f,title:g,keepAtBottom:!1,isTabRaised:!1,isBlinkingUnread:!1,badgeCount:0,allSeenNewComments:{},unseenCommentsSinceLastCleared:{},hasFakeInitBadge:!1}};function a(a,c,d,e){__p&&__p();var f=arguments.length<=4||arguments[4]===undefined?!1:arguments[4],g=arguments.length<=5||arguments[5]===undefined?!1:arguments[5];this.$13=!1;this.$14=!1;this.$1=a;this.$12=c;this.$5=b("guid")();this.$7=null;this.$8=!1;this.$9=null;this.$10=f;this.$11=g;this.$15=e;this.$6=new(b("SubscriptionsHandler"))();this.$16();this.$17();d!=null&&k.modifyTabState(this.$12,function(a){d?a.hasFakeInitBadge=!1:(a.hasFakeInitBadge=!0,this.$18(1),this.$19(!0))}.bind(this));this.$20()}a.prototype.$20=function(){this.$21(),this.$22(),b("ConversationNubUtils").informShouldRecheckTabVisibility(this),this.forceReflow()};a.prototype.getPersistentState=function(){return k.getTabState(this.$12)};a.prototype.getPersistentStateIfExists=function(){return k.getTabStateIfExists(this.$12)};a.prototype.$16=function(){__p&&__p();var a=this.$23();if(a){this.$6.addSubscriptions(b("EventListener").listen(a,"click",this.$24.bind(this)),b("EventListener").listen(a,"mouseenter",this.$25.bind(this)),b("EventListener").listen(a,"mouseleave",this.$26.bind(this)));a=b("ConversationNubUtils").getCloseButtonElem(a);a&&b("ConversationNubUtils").addCloseButtonListeners(a,this.$6,this.$27.bind(this))}a=this.$28();a&&(k.modifyTabState(this.$12,function(a){a.keepAtBottom=!0}),this.$6.addSubscriptions(b("EventListener").listen(a,"scroll",b("debounce")(this.$29.bind(this),n)),b("Arbiter").subscribe("reflow",this.$30.bind(this))));a=this.$31();a&&this.$6.addSubscriptions(b("EventListener").listen(a,"focusin",this.$32.bind(this,!0)),b("EventListener").listen(a,"focusout",this.$32.bind(this,!1)))};a.prototype.$17=function(){__p&&__p();var a=this.$33();if(!a){this.$2=null;return}var c=function(){var a=this.getPersistentState();return{permalinkURI:a.permalinkURI,ftID:a.ftID,tabID:a.tabID}}.bind(this);a=new(b("ConversationNubHeader"))(a,c);this.$6.addSubscriptions(a.subscribe("closeButton",this.$27.bind(this)),a.subscribe("showMenu",this.$34.bind(this)),a.subscribe("hideMenu",this.$35.bind(this)),a.subscribe("minimizeButton",this.$36.bind(this,!0)),a.subscribe("clickHeader",this.$36.bind(this,!0)),a.subscribe("menuPermalinkClick",this.$36.bind(this,!1)),b("UFIComposerIsTypingStore").addListener(function(){var a=this.getPersistentStateIfExists();if(!a)return;var c=this.$14;a=b("UFIComposerIsTypingStore").getValueFor(a.ftID);this.$14=a===!0;c!==this.$14&&b("ConversationNubTabsUpdateEventController").informTabsUpdated()}.bind(this)));this.$2=a};a.prototype.$33=function(){return this.$1&&b("DOM").scry(this.$1,".fbNubFlyoutTitlebar")[0]};a.prototype.$23=function(){return this.$1&&b("DOM").scry(this.$1,".fbNubButton")[0]};a.prototype.$28=function(){!this.$3&&this.$1&&(this.$3=b("DOM").scry(this.$1,".uiScrollableAreaWrap")[0]);return this.$3};a.prototype.$31=function(){!this.$4&&this.$1&&(this.$4=b("DOM").scry(this.$1,".fbNubFlyoutBodyContent")[0]);return this.$4};a.prototype.$37=function(){var a=this.$23();return a?b("DOM").scry(a,"._37op")[0]:null};a.prototype.$27=function(){b("ConversationNubUtils").informShouldCloseTab(this.$12,this.getFeedbackTargetID(),b("ConversationNubUtils").CLOSE_REASON_TAB_X_OUT)};a.prototype.$36=function(a){i(this,a)};a.prototype.$34=function(){this.$1&&b("CSS").addClass(this.$1,"_1uw3")};a.prototype.$35=function(){this.$1&&b("CSS").removeClass(this.$1,"_1uw3")};a.prototype.$24=function(){this.getPersistentState().isTabRaised?i(this,!0):j(this,!0)};a.prototype.$25=function(){this.getPersistentState().isBlinkingUnread&&(this.$9=new Date())};a.prototype.$26=function(){var a=this.$9;if(a&&this.getPersistentState().isBlinkingUnread){var b=new Date();b-a>=m&&this.$19(!1)}this.$9=null};a.prototype.$38=function(){var a=this.$28();if(a){var b=a.scrollHeight;b>0&&!this.$39(a)&&(this.$8=!0,a.scrollTop=b)}};a.prototype.$39=function(a){a=a||this.$28();return!!(a&&a.scrollTop>=a.scrollHeight-a.clientHeight-l)};a.prototype.$29=function(){if(!k.getTabStateIfExists(this.$12)||!this.getPersistentState().isTabRaised)return;k.modifyTabState(this.$12,function(a){a.keepAtBottom=this.$39(),b("ConversationNubUtils").informShouldRecheckTabVisibility(this)}.bind(this));this.$8||this.clearJewelNotifications();this.$8=!1};a.prototype.$32=function(a){if(this.$13===a)return;this.$13=a;this.$13&&this.clearJewelNotifications();b("ConversationNubTabsUpdateEventController").informTabsUpdated()};a.prototype.getIsFocused=function(){return this.$13};a.prototype.getPageID=function(){return this.$15};a.prototype.getHasText=function(){return this.$14};a.prototype.$30=function(){var a=this.getPersistentState();if(!a.isTabRaised)return;a.keepAtBottom&&(this.$38(),this.$7&&clearTimeout(this.$7),this.$7=setTimeout(function(){a.keepAtBottom&&this.$38()}.bind(this),100))};a.prototype.$18=function(a){k.modifyTabState(this.$12,function(b){b.badgeCount=a,this.$21()}.bind(this))};a.prototype.$19=function(a){k.modifyTabState(this.$12,function(b){b.isBlinkingUnread=a,this.$22()}.bind(this))};a.prototype.$21=function(){var a=this.$37();if(!a)return;var c=this.getPersistentState().badgeCount,d=c>0;d?(b("DOM").setContent(a,c),b("CSS").show(a)):(b("CSS").hide(a),b("DOM").setContent(a,c))};a.prototype.$22=function(){if(this.$1){var a=this.getPersistentState().isBlinkingUnread;this.$1&&b("CSS").conditionClass(this.$1,"_53tf",a)}};a.prototype.getRootDOM=function(){return this.$1};a.prototype.getShouldShowIntroNux=function(){return this.$10};a.prototype.getShouldShowHideNux=function(){return this.$11};a.prototype.getTabID=function(){return this.$12};a.prototype.getNotificationPayloadAlertID=function(){return this.getPersistentState().notifAlertID};a.prototype.getNotificationType=function(){return this.getPersistentState().notificationType};a.prototype.setNotificationType=function(a){k.modifyTabState(this.$12,function(b){b.notificationType=a})};a.prototype.getFeedbackTargetID=function(){return this.getPersistentState().ftID};a.prototype.getPermalinkURI=function(){return this.getPersistentState().permalinkURI};a.prototype.getTitle=function(){return this.getPersistentState().title};a.prototype.getBadgeCount=function(){return this.getPersistentState().badgeCount};a.prototype.getIsRaised=function(){return this.getPersistentState().isTabRaised};a.prototype.getSessionID=function(){return this.$5};a.prototype.markCommentsAsSeenWithoutBadging=function(a){k.modifyTabState(this.$12,function(b){a.forEach(function(a){b.allSeenNewComments[a]=!0})})};a.prototype.attemptAddNewCommentsToBadge=function(a){__p&&__p();k.modifyTabState(this.$12,function(b){__p&&__p();a.forEach(function(a){if(b.allSeenNewComments[a])return;b.allSeenNewComments[a]=!0;b.unseenCommentsSinceLastCleared[a]=!0});var c=Object.keys(b.unseenCommentsSinceLastCleared).length;b.hasFakeInitBadge&&(c+=1);var d=b.badgeCount;this.$18(c);this.$19(c>0&&c>d)}.bind(this))};a.prototype.clearBadge=function(){k.clearTabNotifications(this.$12),this.$21(),this.$22()};a.prototype.clearJewelNotifications=function(){var a=this.getNotificationPayloadAlertID();a&&b("NotificationUserActions").markNotificationsAsRead([a])};a.prototype.popOutAndInformTabUpdate=function(){this.popOut(),b("ConversationNubTabsUpdateEventController").informTabsUpdated()};a.prototype.popOut=function(){k.modifyTabState(this.$12,function(a){this.$1&&b("CSS").addClass(this.$1,"_5r93"),a.isTabRaised=!0,this.clearBadge(),a.keepAtBottom&&this.$38()}.bind(this))};a.prototype.minimize=function(){k.modifyTabState(this.$12,function(a){this.$1&&b("CSS").removeClass(this.$1,"_5r93"),a.isTabRaised=!1,this.$2&&this.$2.hideMenu(),this.clearBadge()}.bind(this))};a.prototype.forceReflow=function(){this.$30()};a.prototype.isFormForThisUFI=function(a){return this.$1&&b("containsNode")(this.$1,a)};a.prototype.destroy=function(){this.$6.release(),this.$2&&this.$2.destroy(),this.$2=null,this.$7&&clearTimeout(this.$7),this.minimize(),this.$1&&(b("DOM").remove(this.$1),b("Arbiter").inform("ConversationNub/destroy",{root:this.$1}),this.$1=null)};e.exports=a}),null);
__d("XConversationNubActionTakenController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/conversation/nub_story/action_taken/",{})}),null);
__d("ConversationNubActionTakenReporter",["Arbiter","AsyncRequest","ConversationNubAddCommentSubscription","ConversationNubUtils","PinnedConversationNubsActionTaken","SubscriptionsHandler","XConversationNubActionTakenController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.$2=function(a,c){this.$4(c,b("PinnedConversationNubsActionTaken").COMMENT_ADDED)}.bind(this),this.$3=function(event,a){a.tabID;var c=a.ftID;a.tabState;a.sessionID;a=a.reason;(a===b("ConversationNubUtils").CLOSE_REASON_TAB_X_OUT||a===b("ConversationNubUtils").CLOSE_REASON_OVERFLOW_X_OUT||a===b("ConversationNubUtils").CLOSE_REASON_UNPIN)&&this.$4(c,b("PinnedConversationNubsActionTaken").TAB_CLOSED_BY_USER)}.bind(this),this.$1=new(b("SubscriptionsHandler"))(b("ConversationNubAddCommentSubscription").subscribe(this.$2),b("Arbiter").subscribe(b("ConversationNubUtils").CLOSE_TAB_EVENT,this.$3))}a.prototype.destroy=function(){this.$1.release()};a.prototype.$4=function(a,c){var d=b("XConversationNubActionTakenController").getURIBuilder().getURI();new(b("AsyncRequest"))().setURI(d).setMethod("POST").setData({ft_id:a,action:c}).setAllowCrossPageTransition(!0).send()};e.exports=a}),null);
__d("ConversationNubHeader",["csx","ArbiterMixin","Bootloader","ConversationNubUtils","DOM","Event","EventListener","Keys","SubscriptionsHandler","ifRequired","mixin"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;function i(a,c){return b("EventListener").listen(a,"keydown",function(a){b("Event").getKeyCode(a)===b("Keys").RETURN&&c(a)})}c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));h=c&&c.prototype;function a(a,c){h.constructor.call(this),this.$ConversationNubHeader6=!1,this.$ConversationNubHeader1=a,this.$ConversationNubHeader3=c,this.$ConversationNubHeader4=null,this.$ConversationNubHeader5=!1,this.$ConversationNubHeader2=new(b("SubscriptionsHandler"))(),this.$ConversationNubHeader7()}a.prototype.$ConversationNubHeader7=function(){var a=this.$ConversationNubHeader1;this.$ConversationNubHeader2.addSubscriptions(b("EventListener").listen(a,"click",this.$ConversationNubHeader8.bind(this)));a=b("ConversationNubUtils").getCloseButtonElem(a);a&&b("ConversationNubUtils").addCloseButtonListeners(a,this.$ConversationNubHeader2,this.$ConversationNubHeader9.bind(this));a=this.$ConversationNubHeader10();a&&this.$ConversationNubHeader2.addSubscriptions(b("EventListener").listen(a,"click",this.$ConversationNubHeader11.bind(this)),i(a,this.$ConversationNubHeader11.bind(this)));a=this.$ConversationNubHeader12();a&&this.$ConversationNubHeader2.addSubscriptions(b("EventListener").listen(a,"click",this.$ConversationNubHeader13.bind(this)),b("EventListener").listen(a,"mouseover",this.$ConversationNubHeader14.bind(this)),b("EventListener").listen(a,"focus",this.$ConversationNubHeader15.bind(this)),i(a,this.$ConversationNubHeader16.bind(this)))};a.prototype.$ConversationNubHeader12=function(){return b("DOM").scry(this.$ConversationNubHeader1,"._1rf1")[0]};a.prototype.$ConversationNubHeader10=function(){return b("DOM").scry(this.$ConversationNubHeader1,"._4a56")[0]};a.prototype.$ConversationNubHeader17=function(){return b("ConversationNubUtils").getCloseButtonElem(this.$ConversationNubHeader1)};a.prototype.$ConversationNubHeader9=function(){this.inform("closeButton")};a.prototype.$ConversationNubHeader11=function(a){a.type==="click"&&a.kill(),this.inform("minimizeButton")};a.prototype.$ConversationNubHeader8=function(){this.inform("clickHeader")};a.prototype.$ConversationNubHeader18=function(){this.inform("showMenu")};a.prototype.$ConversationNubHeader19=function(){this.inform("hideMenu");var a=this.$ConversationNubHeader12();a&&a.blur()};a.prototype.$ConversationNubHeader20=function(){this.inform("menuPermalinkClick")};a.prototype.$ConversationNubHeader21=function(a){__p&&__p();if(this.$ConversationNubHeader4)return;var c=this.$ConversationNubHeader12();if(!c)return;a&&(this.$ConversationNubHeader5=!0);b("Bootloader").loadModules(["React","ReactDOM","ConversationNubHeaderMenu.react"],function(a,b,d){if(this.$ConversationNubHeader6)return;var e=babelHelpers["extends"]({},this.$ConversationNubHeader3(),{onMenuShow:this.$ConversationNubHeader18.bind(this),onMenuHide:this.$ConversationNubHeader19.bind(this),onPermalinkClick:this.$ConversationNubHeader20.bind(this),showOnMount:this.$ConversationNubHeader5});this.$ConversationNubHeader4=b.render(a.createElement(d,e),c)}.bind(this),"ConversationNubHeader")};a.prototype.$ConversationNubHeader13=function(a){a.kill(),this.$ConversationNubHeader21(!0)};a.prototype.$ConversationNubHeader14=function(){this.$ConversationNubHeader21(!1)};a.prototype.$ConversationNubHeader15=function(){this.$ConversationNubHeader21(!1)};a.prototype.$ConversationNubHeader16=function(){this.$ConversationNubHeader4?this.$ConversationNubHeader4.toggle():this.$ConversationNubHeader21(!0)};a.prototype.hideMenu=function(){this.$ConversationNubHeader4&&this.$ConversationNubHeader4.hide()};a.prototype.destroy=function(){this.$ConversationNubHeader6=!0;var a=this.$ConversationNubHeader12();a&&this.$ConversationNubHeader4&&b("ifRequired")("ReactDOM",function(b){b.unmountComponentAtNode(a)});this.$ConversationNubHeader2.release()};e.exports=a}),null);
__d("ConversationNubTabsUpdateEventController",["Arbiter","ConversationNubUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="ConversationNub/tabsUpdated",h="ConversationNub/minimizedByUser",i="ConversationNub/maximizedByUser",j=!1;function k(a){j||b("Arbiter").inform(g,a)}function a(a){return b("Arbiter").subscribe(g,function(b,c){j=!0,a(c),j=!1})}function c(a,c){c&&b("Arbiter").inform(h,{tab:a}),a.minimize(),k()}function d(a,c){if(!c&&!b("ConversationNubUtils").allowProgrammaticPopOut())return;c&&b("Arbiter").inform(i,{tab:a});a.popOut();k()}e.exports={TAB_MINIMIZED_BY_USER_EVENT:h,TAB_MAXIMIZED_BY_USER_EVENT:i,informTabsUpdated:k,subscribeToTabsUpdated:a,minimizeAndInformTabUpdate:c,popOutAndInformTabUpdate:d}}),null);
__d("XConversationNubTogglePinController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/conversation/nub_story/toggle_pin/",{ft_id:{type:"String"},pin:{type:"Bool",defaultValue:!1},with_render:{type:"Bool",defaultValue:!1},notif_setting:{type:"Enum",enumType:1}})}),null);
__d("XConversationsToggleController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/conversation/toggle_feature/",{turn_conversations_on:{type:"Bool",defaultValue:!1}})}),null);
__d("isBusinessURI",["isFacebookURI"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("isFacebookURI")(a)&&a.getSubdomain()==="business"}e.exports=a}),null);
__d("isGamesURI",["isFacebookURI"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("isFacebookURI")(a)&&a.getPath().startsWith("/games")}e.exports=a}),null);
__d("ConversationNubUtils",["csx","Arbiter","AsyncRequest","ConversationNubTabState","DOM","Event","EventListener","Keys","NotificationConversationController","URI","XConversationNubTogglePinController","XConversationsToggleController","isBusinessURI","isCanvasAppURI","isGamesURI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ConversationNubTabState"),i=Object.freeze({DISABLE:"disable",ENABLE:"enable"}),j="ConversationNubUtils/closeTab",k="ConversationNubUtils/unpinnedFromHeader",l="ConversationNubUtils/recheckTabVisibility",m="ConversationNubUtils/openPermalinkFromHeader",n="ConversationNubUtils/turnOff",o="ConversationNubUtils/turnOn",p="tab-x-out",q="browser-tab-sync",r="overflow-x-out",s="unpin";function a(a){var b=Object.values(i);return b.find(function(b){return b===a})||null}function t(a,c,d,e){e=e||{};e=e.notif_setting;a=b("XConversationNubTogglePinController").getURIBuilder().setString("ft_id",String(a)).setBool("pin",c);e&&a.setEnum("notif_setting",e);c=a.getURI();e=new(b("AsyncRequest"))().setURI(c).setMethod("POST");d&&e.setAllowCrossPageTransition(!0);e.send()}function u(a){var c=b("XConversationsToggleController").getURIBuilder().setBool("turn_conversations_on",a).getURI();a?H():G();c=new(b("AsyncRequest"))().setURI(c).setAllowCrossPageTransition(!0).setHandler(function(a){a.getPayload().conversationsStatus?H():G()}).setErrorHandler(function(b){a?G():H()}).setMethod("POST");c.send()}function v(a,b,c){t(a,!0,b,c)}function w(a,b,c){t(a,!1,b,c)}function c(a,b){v(a,!1,b)}function d(a,b){w(a,!1,b)}function f(a,b){v(a,!0,b)}function g(a,b){w(a,!0,b)}function x(){u(!1),b("NotificationConversationController").deleteAllTabs()}function y(){u(!0)}function z(a){return b("DOM").scry(a,"._4iz6")[0]}function A(a,c,d){var e=function(){d()};c.addSubscriptions(b("EventListener").listen(a,"click",e),b("EventListener").listen(a,"keydown",function(a){b("Event").getKeyCode(a)===b("Keys").RETURN&&e()}))}function B(){var a=b("URI").getRequestURI();return!b("isCanvasAppURI")(a)&&!b("isBusinessURI")(a)&&!b("isGamesURI")(a)}function C(a,c,d){var e=h.getLoadedTab(a);if(!e)return;var f=e.getPersistentState(),g=e.getSessionID();e=e.getPageID();b("Arbiter").inform(j,{tabID:a,ftID:c,tabState:f,sessionID:g,reason:d,pageID:e})}function D(a){a=h.getLoadedTab(a);if(!a)return;b("Arbiter").inform(k,{tab:a})}function E(a){b("Arbiter").inform(l,{tab:a})}function F(a){a=h.getLoadedTab(a);if(!a)return;b("Arbiter").inform(m,{tab:a})}function G(){b("Arbiter").inform(n,{})}function H(){b("Arbiter").inform(o,{})}e.exports={CLOSE_TAB_EVENT:j,UNPIN_FROM_HEADER_EVENT:k,OPEN_PERMALINK_FROM_HEADER_EVENT:m,TURN_CONVERSATIONS_OFF_EVENT:n,TURN_CONVERSATIONS_ON_EVENT:o,CLOSE_REASON_TAB_X_OUT:p,CLOSE_REASON_SYNCHRONIZED_FROM_OTHER_TAB:q,CLOSE_REASON_OVERFLOW_X_OUT:r,CLOSE_REASON_UNPIN:s,coerceToPinRequestNotifSetting:a,sendPinRequest:c,sendUnpinRequest:d,sendPinRequestAcrossTransitions:f,sendUnpinRequestAcrossTransitions:g,getCloseButtonElem:z,addCloseButtonListeners:A,informShouldCloseTab:C,informDidUnpinFromHeaderMenu:D,informShouldRecheckTabVisibility:E,informOpenPermalinkFromHeader:F,allowProgrammaticPopOut:B,turnConversationsOff:x,turnConversationsOn:y}}),null);
__d("ConversationNubPermalinkUtils",["URI","isFacebookURI"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){return a.substr(-1)==="/"?a.slice(0,-1):a}function h(a,b){a=a.getPath();b=b.getPath();return g(a)===g(b)}function i(a,b,c){a=a.getQueryData();b=b.getQueryData();a=a[c];b=b[c];return a==null&&b==null?!0:a===b}function a(a){var c=new(b("URI"))(window.location.href);return c&&a&&b("isFacebookURI")(c)&&b("isFacebookURI")(a)&&h(c,a)&&i(c,a,"fbid")&&i(c,a,"story_fbid")}e.exports={isOnPermalink:a}}),null);
__d("ConversationNubViewportManager",["DockTabsViewportCalculator","DockTabsViewportPinnedConversationTabUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("DockTabsViewportPinnedConversationTabUtils").getMinRequiredWidthForFirstConvoTab;function a(a,c,d){this.$1=a,this.$3=c,this.$2=b("DockTabsViewportCalculator").getInstance(this.$1),this.$2&&this.$2.registerPinnedConvoTabCallbacks(babelHelpers["extends"]({},d,{pinnedConvoTabStateGetter:function(){return this.$3}.bind(this)}))}a.prototype.getNumDockTabsToShow=function(a){return this.getCouldFitAtLeastOneDockTab(a)?1:0};a.prototype.getCouldFitAtLeastOneDockTab=function(a){var b=g();return b<=a};a.prototype.forceRecalculatePinnedConvoTabs=function(a){this.$2&&this.$2.forceRecalculatePinnedConvoTabs(a)};e.exports=a}),null);
__d("ConversationNubVisibilityDedupeUtils",["Bootloader","emptyFunction","ifRequired"],(function(a,b,c,d,e,f){"use strict";function a(a){b("Bootloader").loadModules(["UFICommentVisibilityStore"],a,"ConversationNubVisibilityDedupeUtils")}function c(a){return b("ifRequired")("UFICommentVisibilityStore",function(b){return b.isFeedbackTargetVisible(a)},b("emptyFunction").thatReturnsFalse)}e.exports={bootloadUFIVisibilityModule:a,isFeedbackTargetVisible:c}}),null);
__d("XNotificationNubStoryController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/conversation/nub_story/",{notif_alert_id:{type:"String"},notif_id:{type:"Int"},ft_id:{type:"String"},force_minimized:{type:"Bool",defaultValue:!1}})}),null);
__d("NotificationConversationController",["csx","cx","Arbiter","AsyncRequest","Bootloader","ConversationNub","ConversationNubActionTakenReporter","ConversationNubPermalinkUtils","ConversationNubTabState","ConversationNubTabsUpdateEventController","ConversationNubUtils","ConversationNubViewportManager","ConversationNubVisibilityDedupeUtils","CSS","DOM","PinnedConversationNubsConfig","SubscriptionsHandler","URI","XNotificationNubStoryController","ge","ifRequired","nullthrows"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("ConversationNubVisibilityDedupeUtils").isFeedbackTargetVisible,j=1,k=b("ConversationNubTabState"),l=Object.create(null),m=null,n=null,o=null,p=null,q=null,r=null,s=!1,t=null,u=null,v=null,w=null,x=Object.create(null);function y(){n||(n=b("DOM").scry(b("ge")("pagelet_dock"),"._1mw-")[0]);return n}function z(){if(!o){var a=y();a&&(o=b("DOM").scry(a,"._1tvj")[0])}return o}function A(){if(!p){var a=y();a&&(p=b("DOM").scry(a,"._2ikx .fbNubButton")[0])}return p}a.prototype.init=function(){__p&&__p();if(s)return;s=!0;var a=new(b("SubscriptionsHandler"))();a.addSubscriptions(b("ConversationNubTabsUpdateEventController").subscribeToTabsUpdated(this.$2.bind(this)),b("Arbiter").subscribe(b("ConversationNubUtils").CLOSE_TAB_EVENT,function(a,b){a=b||{};b=a.tabID;b&&this.$3(b)}.bind(this)));this.$1=new(b("ConversationNubActionTakenReporter"))();t=a};a.prototype.$4=function(a){a=m?m.getNumDockTabsToShow(a):j;k.setMaxDockTabs(a)};a.prototype.$5=function(a,c){this.$4(a);if(c){var d=c.tabToPromote;c=c.tabToOpenIfInDock;d&&!k.isTabInDock(d.getTabID())&&k.moveTabToDockLeft(d.getTabID());b("ConversationNubUtils").allowProgrammaticPopOut()&&c&&k.isTabInDock(c.getTabID())&&c.popOut()}this.$6(a)};a.prototype.$2=function(a){m&&m.forceRecalculatePinnedConvoTabs(a)};a.prototype.$6=function(a){__p&&__p();var c=k.getTotalTabCount(),d=k.getNumDockTabs();a=m?m.getCouldFitAtLeastOneDockTab(a):!1;a=c>0&&a;d=d<c&&a;c=y();c&&(b("CSS").conditionClass(c,"_1tvf",a),b("CSS").conditionClass(c,"_1dex",d),b("CSS").conditionClass(c,"_1tvi",d));a=b("PinnedConversationNubsConfig").pinnedToLeft?k.getTabsForDockOldestFirst():k.getTabsForDockNewestFirst();a.forEach(function(a){a.getIsRaised()&&a.clearBadge()});c=k.getTabsForMenuNewestFirst();this.$7(a);this.$8(c)};a.prototype.handleNotificationsRead=function(a){this.init();k.getUnsortedLoadedTabs().forEach(function(b){var c=b.getNotificationPayloadAlertID();c&&a[c]&&b.clearBadge()});k.getUnloadedTabs().forEach(function(b){b.notifAlertID&&a[b.notifAlertID]&&k.clearTabNotifications(b.tabID)});var b=k.getTabsForMenuNewestFirst();this.$8(b)};a.prototype.handleNewNotificationFromGraphQL=function(a,c){this.init();a=b("nullthrows")(a);var d=a.tab_id,e=a.notification,f=a.feedback_target_id;a=a.permalink_uri;e=b("nullthrows")(e);var g=e.notif_id,h=e.alert_id;e=e.notif_type;this.$9(b("nullthrows")(d),b("nullthrows")(g),b("nullthrows")(f),b("nullthrows")(h),a?new(b("URI"))(a):null,c,e)};a.prototype.$9=function(a,c,d,e,f,g,h){e=b("XNotificationNubStoryController").getURIBuilder().setString("notif_alert_id",e).setInt("notif_id",c);this.$10(d,g);this.$11(a,d,h,f,e)};a.prototype.$10=function(a,b){x[a]||(x[a]=b)};a.prototype.$11=function(a,c,d,e,f){__p&&__p();if(l[a])return;var g=k.getLoadedTab(a);if(g){d&&g.setNotificationType(d);return}(b("ConversationNubPermalinkUtils").isOnPermalink(e)||i(c))&&f.setBool("force_minimized",!0);l[a]=!0;new(b("AsyncRequest"))().setURI(f.getURI()).setAllowCrossPageTransition(!0).setFinallyHandler(function(){delete l[a]}).send()};a.prototype.$12=function(a){__p&&__p();var c=!0;k.getUnsortedLoadedTabs().forEach(function(b){var d=b.getFeedbackTargetID(),e=a[d];e=e?Object.keys(e):[];if(e.length){var f=b.getBadgeCount();i(d)?(b.markCommentsAsSeenWithoutBadging(e),b.clearBadge()):b.attemptAddNewCommentsToBadge(e);d=b.getBadgeCount();f!==d&&(c=!0)}});c&&b("ConversationNubTabsUpdateEventController").informTabsUpdated()};a.prototype.$13=function(a){if(w)return;b("Bootloader").loadModules(["ConversationNubSurveys"],function(b){w||(w=new b(a))},"NotificationConversationController")};a.prototype.$14=function(a,c,d){if(v){v.addTab(a,d);delete x[a.getPersistentState().ftID];return}b("Bootloader").loadModules(["ConversationNubLogger"],function(b){v||(v=new b(c)),v.addTab(a,d),delete x[a.getPersistentState().ftID]},"NotificationConversationController")};a.prototype.$15=function(){if(u)return;b("Bootloader").loadModules(["ConversationNubUFICentralUpdateManager"],function(a){if(u)return;u=new a(this.$12.bind(this))}.bind(this),"NotificationConversationController")};a.prototype.$7=function(a){var c=z();if(!c)return;b("Bootloader").loadModules(["React","ReactDOM","ConversationNubDockedTabGroup.react"],function(b,d,e){r=d.render(b.createElement(e,{dockTabs:a}),c)},"NotificationConversationController")};a.prototype.$16=function(a){a.popOut(),b("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:a})};a.prototype.$8=function(a){var c=A();if(!c)return;b("Bootloader").loadModules(["React","ReactDOM","ConversationNubCollapsedSelectorMenu.react"],function(b,d,e){q=d.render(b.createElement(e,{menuTabs:a,onTabSelected:this.$16}),c)}.bind(this),"NotificationConversationController")};a.prototype.$17=function(){if(!m){var a=y();if(a){var c={onAvailableWidthChanged:this.$5.bind(this)};m=new(b("ConversationNubViewportManager"))(a,k,c)}}};a.prototype.storyFromServer=function(a,c){__p&&__p();s||this.init();var d=c.attempt_open_on_init,e=c.ft_id,f=c.init_without_badge,g=c.notif_alert_id,h=c.notification_type,j=c.permalink_uri,l=c.promote_on_init,m=c.tab_add_source,n=c.tab_id,o=c.title,p=c.should_show_intro_nux,q=c.should_show_hide_nux;c=c.page_id;var r=k.getLoadedTab(n);if(r){(l||d)&&b("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:l?r:null,tabToOpenIfInDock:d?r:null});return}f=f||i(e);r=k.getTabStateIfExists(n);if(r)f=null;else{r=b("ConversationNub").createDefaultState(n,j,e,g,h,o);k.addTabState(r)}j=new(b("ConversationNub"))(a,n,f,c,Boolean(p),Boolean(q));k.addLoadedTab(n,j);d=d||j.getPersistentState().isTabRaised;this.$15();this.$17();b("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:l?j:null,tabToOpenIfInDock:d?j:null});this.$13(k);g=x[e]||m||"unknown";this.$14(j,k,g)};a.prototype.deleteAllTabs=function(){k.deleteAllTabs(),b("ConversationNubTabsUpdateEventController").informTabsUpdated()};a.prototype.$3=function(a){a=k.deleteTab(a);a&&b("ConversationNubTabsUpdateEventController").informTabsUpdated()};a.prototype.unsubscribe=function(){t&&t.release(),t=null,v&&v.destroy(),v=null,w&&w.destroy(),w=null,u&&u.destroy(),u=null,this.$1.destroy(),b("ifRequired")("ReactDOM",function(a){var b=A();q&&b&&a.unmountComponentAtNode(b);b=z();r&&b&&a.unmountComponentAtNode(b)})};function a(){}e.exports=new a()}),null);
__d("PinnedConversationTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAttemptOpenOnInit=function(a){this.$1.attempt_open_on_init=a;return this};a.prototype.setBadgeCount=function(a){this.$1.badge_count=a;return this};a.prototype.setClientEventTimeMs=function(a){this.$1.client_event_time_ms=a;return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setFtID=function(a){this.$1.ft_id=a;return this};a.prototype.setIsRaised=function(a){this.$1.is_raised=a;return this};a.prototype.setNotificationType=function(a){this.$1.notification_type=a;return this};a.prototype.setPageID=function(a){this.$1.page_id=a;return this};a.prototype.setPromoteOnInit=function(a){this.$1.promote_on_init=a;return this};a.prototype.setReason=function(a){this.$1.reason=a;return this};a.prototype.setTabID=function(a){this.$1.tab_id=a;return this};a.prototype.setTabSessionID=function(a){this.$1.tab_session_id=a;return this};a.prototype.setTabsInDock=function(a){this.$1.tabs_in_dock=a;return this};a.prototype.setTabsInMenu=function(a){this.$1.tabs_in_menu=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};a.prototype.setWindowInnerHeight=function(a){this.$1.window_inner_height=a;return this};a.prototype.setWindowInnerWidth=function(a){this.$1.window_inner_width=a;return this};c={attempt_open_on_init:!0,badge_count:!0,client_event_time_ms:!0,event:!0,ft_id:!0,is_raised:!0,notification_type:!0,page_id:!0,promote_on_init:!0,reason:!0,tab_id:!0,tab_session_id:!0,tabs_in_dock:!0,tabs_in_menu:!0,vc:!0,window_inner_height:!0,window_inner_width:!0};e.exports=a}),null);
__d("ConversationNubLogger",["Arbiter","ConversationNubAddCommentSubscription","ConversationNubTabsUpdateEventController","ConversationNubUtils","PinnedConversationTypedLogger","SubscriptionsHandler","UFIUIEvents"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.$1=new(b("SubscriptionsHandler"))(),this.$2=a,this.$3(),this.$4()}a.prototype.$4=function(){__p&&__p();this.$1.addSubscriptions(b("ConversationNubAddCommentSubscription").subscribe(function(a){var c=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_add_comment");this.$5(c,a)}.bind(this))),this.$1.addSubscriptions(b("Arbiter").subscribe(b("UFIUIEvents").ReactionButtonClicked,function(a,c){a=c.ft_id;if(!a)return;c=this.$2.getLoadedTabByFeedbackTarget(a);if(!c)return;a=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_react_post");this.$5(a,c)}.bind(this)))};a.prototype.$3=function(){__p&&__p();this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubUtils").CLOSE_TAB_EVENT,function(a,c){a=c.tabState;var d=c.sessionID;c=c.reason;c=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_close").setReason(c);this.$6(c,a,d)}.bind(this))),this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubUtils").UNPIN_FROM_HEADER_EVENT,function(a,c){a=c.tab;c=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_hide");this.$5(c,a)}.bind(this))),this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubTabsUpdateEventController").TAB_MAXIMIZED_BY_USER_EVENT,function(a,c){a=c.tab;c=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_maximize");this.$5(c,a)}.bind(this))),this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubTabsUpdateEventController").TAB_MINIMIZED_BY_USER_EVENT,function(a,c){a=c.tab;c=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_minimize");this.$5(c,a)}.bind(this))),this.$1.addSubscriptions(b("Arbiter").subscribe(b("ConversationNubUtils").OPEN_PERMALINK_FROM_HEADER_EVENT,function(a,c){a=c.tab;c=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_open_permalink_from_header");this.$5(c,a)}.bind(this)))};a.prototype.$5=function(a,b){a.setTabID(b.getTabID()).setPageID(b.getPageID()).setClientEventTimeMs(Date.now()).setTabsInMenu(this.$2.getNumMenuTabs()).setTabsInDock(this.$2.getNumDockTabs()).setWindowInnerWidth(window.innerWidth).setWindowInnerHeight(window.innerHeight);a.setFtID(b.getFeedbackTargetID()).setIsRaised(b.getIsRaised()).setBadgeCount(b.getBadgeCount()).setTabSessionID(b.getSessionID());b=b.getNotificationType();b&&a.setNotificationType(b);a.log()};a.prototype.$6=function(a,b,c){a.setTabID(b.tabID).setClientEventTimeMs(Date.now()).setTabsInMenu(this.$2.getNumMenuTabs()).setTabsInDock(this.$2.getNumDockTabs()).setWindowInnerWidth(window.innerWidth).setWindowInnerHeight(window.innerHeight),a.setFtID(b.ftID).setIsRaised(b.isTabRaised).setBadgeCount(b.badgeCount).setTabSessionID(c),b.notificationType&&a.setNotificationType(b.notificationType),a.log()};a.subscriptionTriggered=function(a){new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_subscription_triggered").setReason(a).log()};a.prototype.addTab=function(a,c){c=new(b("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_add").setReason(c);this.$5(c,a)};a.prototype.destroy=function(){this.$1.release()};e.exports=a}),null);
__d("ConversationNotificationListeners",["Bootloader","ConversationNubAddTabSource","ConversationNubLogger","FacebookWebNotificationsSubscription","NotificationConstants","NotificationUpdates","once"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("NotificationConstants").PayloadSourceType.LIVE_SEND;function h(){b("NotificationUpdates").subscribe("update-notifications",function(a,c){c.payloadsource===g&&c.readState&&Object.keys(c.readState).length&&b("Bootloader").loadModules(["NotificationConversationController"],function(a){a.handleNotificationsRead(c.readState)},"ConversationNotificationListeners")})}var i=b("once")(function(){h(),b("FacebookWebNotificationsSubscription").subscribe({event:"NEW_PINNED_CONVERSATION",callback:function(a){b("ConversationNubLogger").subscriptionTriggered("graphql"),b("Bootloader").loadModules(["NotificationConversationController"],function(c){c.handleNewNotificationFromGraphQL(a,b("ConversationNubAddTabSource").NOTIFICATION)},"ConversationNotificationListeners")}})});e.exports={initialize:function(){i()}}}),null);
__d("FBPaymentsDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){"use strict";var g;c=babelHelpers.inherits(a,b("ExplicitRegistrationReactDispatcher"));g=c&&c.prototype;function a(a){g.constructor.call(this,a),this.dispatch=this.dispatch.bind(this)}e.exports=new a({strict:!1})}),null);
__d("FBPaymentsDialogActions",["FBPaymentsDispatcher","keyMirror"],(function(a,b,c,d,e,f){"use strict";var g={types:b("keyMirror")({SHOW_DIALOG:null,HIDE_DIALOG:null}),showDialog:function(a,c){b("FBPaymentsDispatcher").dispatch({type:g.types.SHOW_DIALOG,data:{dialogClass:a,dialogProps:c}})},hideDialog:function(){b("FBPaymentsDispatcher").dispatch({type:g.types.HIDE_DIALOG,data:{}})}};e.exports=g}),null);
__d("FBPaymentsDialogStore",["FBPaymentsDialogActions","FBPaymentsDispatcher","FluxStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("FluxStore"));g=c&&c.prototype;function a(){g.constructor.call(this,b("FBPaymentsDispatcher")),this.$FBPaymentsDialogStore1={dialogClass:null,dialogProps:null}}a.prototype.__onDispatch=function(a){var c=a.type;a=a.data;switch(c){case b("FBPaymentsDialogActions").types.SHOW_DIALOG:this.$FBPaymentsDialogStore1={dialogClass:a.dialogClass,dialogProps:a.dialogProps};this.__emitChange();break;case b("FBPaymentsDialogActions").types.HIDE_DIALOG:this.$FBPaymentsDialogStore1={dialogClass:null,dialogProps:null};this.__emitChange();break}};a.prototype.getState=function(){return this.$FBPaymentsDialogStore1};a.__moduleID=e.id;e.exports=new a()}),null);
__d("FBPaymentsDialogContainer.react",["FBPaymentsDialogStore","FBPaymentsDispatcher","FluxContainer","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.calculateState=function(){return b("FBPaymentsDialogStore").getState()};a.getStores=function(){return[b("FBPaymentsDialogStore")]};a.prototype.UNSAFE_componentWillMount=function(){b("FBPaymentsDispatcher").explicitlyRegisterStore(b("FBPaymentsDialogStore"))};a.prototype.render=function(){if(!this.state.dialogClass)return null;var a=this.state.dialogClass;return b("React").createElement(a,babelHelpers["extends"]({},this.state.dialogProps,{key:"dialog"}))};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a)}),null);
__d("FBPaymentsDialogContainerMount",["FBPaymentsDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").createElement(b("FBPaymentsDialogContainer.react"),null),a)}};e.exports=a}),null);
__d("ChatTimezoneWarning",["MercuryParticipants","MercuryViewer","MessengerBotIDs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=1;a={updateUserTimezoneWarning:function(a,c,d){__p&&__p();b("MercuryParticipants").get(b("MercuryViewer").getID(),function(e){__p&&__p();var f=e.employee,h=e.timezone,i=0;if(a.timezone_warning_dismiss_count!==undefined){var j=a.timezone_warning_dismiss_count;for(var j=Object.entries(j),k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=j.length)break;m=j[l++]}else{l=j.next();if(l.done)break;m=l.value}m=m;var n=m[0];m=m[1];n===e.fbid&&(i=Number(m))}}else return;f&&h&&i<g&&b("MercuryParticipants").getMulti(a.participants,function(a){__p&&__p();var f={},g=!0;for(var i in a){g=g&&a[i].employee;var j=!!b("MessengerBotIDs")[a[i].fbid];if(a[i].timezone!==undefined&&a[i].timezone!==null&&h!==a[i].timezone&&!j){j=a[i].fbid;f[j]=a[i]}}Object.keys(f).length>0&&g?(f.self=e,c(f)):d()})})}};e.exports=a}),null);
__d("ChatVideoCallButton.react",["cx","fbt","invariant","Bootloader","FantaAvailableStatus","FBIDCheck","FBRTCCallabilityStore","FBRTCCore","RTWebUserActionLogger","RTWebLoggingPage","RTWebLoggingSurface","immutable","ImmutableObject","Keys","LayerFadeOnHide","Link.react","MercuryIDs","MercuryParticipants","MercuryThreadIDMap","MessengerRTCFunnelLogger","ReactComponentWithPureRenderMixin","React","RTCCallState","TrackingNodes","FBRTCLogger","VideoCallTypedLogger","XUIAmbientNUX.react"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("MercuryThreadIDMap").get(),k=b("FBRTCLogger").Trigger;a=b("React").PropTypes;var l={isCallable:!1,user:null};c=b("React").createClass({displayName:"ChatVideoCallButton",mixins:[b("ReactComponentWithPureRenderMixin")],_subscription:null,_rtcStoreSubscription:null,propTypes:{isAudio:a.bool,isGroupChat:a.bool,onRTCNuxCloseButtonClick:a.func.isRequired,rtcNuxShown:a.bool.isRequired,threadID:a.string,thread:a.object,viewer:a.string.isRequired,shown:a.bool,rtcCallData:a.object.isRequired},getDefaultProps:function(){return{shown:!0,rtcCallData:{call_state:"NO_ONGOING_CALL"}}},getInitialState:function(){return babelHelpers["extends"]({},l)},componentDidMount:function(){var a=this.props,c=a.isAudio;a=a.isGroupChat;a=b("RTWebUserActionLogger").getCallType(a);c=b("RTWebUserActionLogger").getAudioVideoComponent(c);b("RTWebUserActionLogger").logImpression({callType:a,page:b("RTWebLoggingPage").FACEBOOK,surface:b("RTWebLoggingSurface").CHAT_TAB,component:c});this.setState({isCallable:this._getIsCallable(),user:this._computeParticipant()});this._rtcStoreSubscription=b("FBRTCCallabilityStore").addListener(function(a){this.setState({isCallable:this._getIsCallable(),user:this._computeParticipant()})}.bind(this))},componentDidUpdate:function(){if(!this._subscription){var a=this._getParticipantID();this.state.user&&this.state.user.id!==a&&this.setState({user:this._computeParticipant()})}a=this._getIsCallable();a!==this.state.isCallable&&this.setState({isCallable:a})},componentWillUnmount:function(){this._subscription&&this._subscription.remove(),this._rtcStoreSubscription&&this._rtcStoreSubscription.remove()},_getParticipantID:function(){var a=b("MercuryIDs").getUserIDFromThreadID(this.props.threadID);if(a===this.props.viewer||!b("FBIDCheck").isUser_deprecated(a))return null;a&&b("FBIDCheck").isUser_deprecated(a)||i(0);return b("MercuryIDs").getParticipantIDFromUserID(a)},_computeParticipant:function(){var a=this._getParticipantID(),c=null;if(a){var d=b("MercuryParticipants").getNow(a);this._subscription&&this._subscription.remove();d?(this._subscription=null,c=d):this._subscription=b("MercuryParticipants").getMulti([a],function(b){this._subscription=null,this.setState({user:b[a]})}.bind(this))}return c},_getIsCallable:function(){if(!this.props.threadID)return!1;if(this.props.isGroupChat)return!0;var a=b("MercuryIDs").getUserIDFromThreadID(this.props.threadID);if(a===this.props.viewer||!b("FBIDCheck").isUser_deprecated(a))return!1;a&&b("FBIDCheck").isUser_deprecated(a)||i(0);return!b("FBRTCCallabilityStore").isBlocked(a,this.props.thread)&&b("FBRTCCallabilityStore").isCallable(a,this.props.thread)},getTooltipLabel:function(){if(this.props.isGroupChat)return this.props.isAudio?h._("Start a group call"):h._("Start a group video chat");var a=this.state.user;return!a||!a.fbid?undefined:this.props.isAudio?b("FBRTCCallabilityStore").voiceCallButtonTooltip(a.fbid,a.short_name,this.state.isCallable,this.props.thread):b("FBRTCCallabilityStore").callButtonTooltip(a.fbid,a.short_name,this.state.isCallable,this.props.thread)},render:function(){if(!this.props.shown)return null;var a=b("TrackingNodes").getTrackingInfo(this.props.isAudio?b("TrackingNodes").types.VIDEOCHAT:b("TrackingNodes").types.VOICECHAT),c=JSON.stringify({videochat:"call_clicked_bhat_tab"}),d=this.props.threadID&&b("FantaAvailableStatus").isAvailable(this.props.thread,this.props.threadID);d=d&&this.state.isCallable;return b("React").createElement("div",null,b("React").createElement(b("Link.react"),{"aria-label":this.getTooltipLabel(),className:"button _3olv"+(this.props.isAudio?" _2fpc":"")+(this.props.isAudio?"":" _2fpd")+(this.state.isCallable?" enabled":""),"data-ft":a,"data-gt":c,"data-hover":"tooltip","data-tooltip-content":this.getTooltipLabel(),"data-tooltip-position":"above",onClick:this._handleClick,onKeyUp:this._handleKeyUp,ref:"button"}),b("React").createElement("div",{className:d&&!this.props.isAudio?"_18pe":""}),b("React").createElement(b("XUIAmbientNUX.react"),{alignment:"right",behaviors:{LayerFadeOnHide:b("LayerFadeOnHide")},contextRef:function(){return this.refs.button}.bind(this),onCloseButtonClick:this.props.onRTCNuxCloseButtonClick,shown:this.props.rtcNuxShown,width:"auto"},h._("You can now make a group call.")))},_handleClick:function(a){a.preventDefault(),this._startCall()},_handleKeyUp:function(a){a.preventDefault();if(a.keyCode!==b("Keys").RETURN)return;a.target&&(a.target instanceof HTMLElement||i(0),a.target.blur());this._startCall()},_startCall:function(){__p&&__p();var a=this.props,c=a.isAudio;a=a.isGroupChat;a=b("RTWebUserActionLogger").getCallType(a);c=b("RTWebUserActionLogger").getAudioVideoComponent(c);b("RTWebUserActionLogger").logClick({callType:a,page:b("RTWebLoggingPage").FACEBOOK,surface:b("RTWebLoggingSurface").CHAT_TAB,component:c});b("MessengerRTCFunnelLogger").startFunnel("ChatTab");if(!this.state.isCallable){b("MessengerRTCFunnelLogger").endFunnel("callee_not_callable");return}this.props.onRTCNuxCloseButtonClick();this._initiateCall()},_initiateCall:function(){__p&&__p();var a=this.props,c=a.isAudio,d=a.isGroupChat;a=a.threadID;!a&&i(0);var e=c?"audio":"video";if(d)b("MercuryIDs").isLocalThread(a)?j.getServerIDFromClientID(a,function(a){return this._initiateGroupCall(a)}.bind(this)):(b("MessengerRTCFunnelLogger").appendAction("start_in_group_thread"),this._initiateGroupCall(b("MercuryIDs").getThreadFBIDFromThreadID(a)));else{d=this.state.user&&this.state.user.fbid;if(!d)return;b("MessengerRTCFunnelLogger").appendAction("start_in_p2p_thread");b("FBRTCCore").startOutgoingCall(d,e,!!c);new(b("VideoCallTypedLogger"))().setEvent("chat_tab_call_click").log()}},_initiateGroupCall:function(a){__p&&__p();var c=this.props,d=c.isAudio;c=c.rtcCallData;var e=c.call_state;c=c.server_info_data;if(e!=="NO_ONGOING_CALL"&&c){b("MessengerRTCFunnelLogger").appendAction("join_existing_call");b("FBRTCCore").startGroupCall({conferenceName:"GROUP:"+a,hasVideo:!d,serverInfoData:c,trigger:e!==b("RTCCallState").AUDIO_GROUP_CALL?d?k.MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_AUDIO_BUTTON:k.MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_VIDEO_BUTTON:d?k.MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_AUDIO_BUTTON:k.MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_VIDEO_BUTTON});return}b("Bootloader").loadModules(["FBRTCSupport","MercuryThreads","MessengerParticipantsFetcher.bs","FBRTCUnsupportedBrowserMessage","MessengerRTCGroupCallParticipantsPickerDialogController"],function(c,d,e,f,g){__p&&__p();if(!c.isGroupCallWebtrcSupported()){b("MessengerRTCFunnelLogger").endFunnel("unsupported_browser");f.showForOutgoingGroupCall();return}d.get().getThreadMeta(this.props.threadID,function(c){var d=c.participants?c.participants.filter(function(a){return a!==b("MercuryIDs").getParticipantIDFromUserID(this.props.viewer)}.bind(this)).map(function(a){return b("MercuryIDs").getUserIDFromParticipantID(a)}):[];d.length>0&&e.fetch({ids:d}).done(function(d){b("MessengerRTCFunnelLogger").appendAction("render_participant_picker"),g.render({participants:b("immutable").Map(d.map(function(a){return[a.id,new(b("ImmutableObject"))(a)]})),thread:c,viewerID:this.props.viewer,trigger:this.props.isAudio?k.MULTIWAY_THREAD_HEADER_AUDIO_BUTTON:k.MULTIWAY_THREAD_HEADER_VIDEO_BUTTON,conferenceName:"GROUP:"+a,hasVideo:!this.props.isAudio})}.bind(this))}.bind(this))}.bind(this),"ChatVideoCallButton.react")}});e.exports=c}),null);
__d("FantaTabMainPlaceholder.react",["cx","React","XUISpinner.react"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return b("React").createElement("div",{className:"_59v1"},b("React").createElement("div",{className:"_5qi9 _5qib"},b("React").createElement("div",{className:"_3_9e _s0f _50mz _50m_ fbNub _50-v opened _27_3"},b("React").createElement("div",{className:"fbNubFlyout fbDockChatTabFlyout uiContextualLayerParent"},b("React").createElement("div",{className:"fbNubFlyoutOuter"},b("React").createElement("div",{className:"fbNubFlyoutInner"},b("React").createElement("div",{className:"_5-kq"},b("React").createElement(b("XUISpinner.react"),null))))))))};e.exports=a}),null);
__d("FantaTabsEagerBootloader",["Bootloader","emptyFunction","ifRequired"],(function(a,b,c,d,e,f){"use strict";var g=function(a){b("ifRequired")("FantaAppStore",function(b){return b.addReducers(a)}),g=b("emptyFunction")};a={bootload:function(){b("ifRequired")("FantaTabsSlimApp",function(a){a.silentPumpUp()}),b("Bootloader").loadModules(["FantaReducersGetMessages","FantaTabsReactApp","MessengerGraphQLThreadFetcher.bs"],function(a){g(a)},"FantaTabsEagerBootloader")}};e.exports=a}),null);
__d("FantaTabsSlimApp",["BootloadOnRender.react","ChatPerfInstrumentation","FantaTabMainPlaceholder.react","FantaTabsAppBase","JSResource","LazyComponent.react","React","ReactDOM","WorkplaceChatHelper","emptyFunction","ifRequired","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=void 0;c=babelHelpers.inherits(a,b("FantaTabsAppBase"));g=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$FantaTabsSlimApp1=!1,this.$FantaTabsSlimApp3=function(a,c){this.$FantaTabsSlimApp1?b("ifRequired")("FantaMessageActions",function(d){b("setImmediate")(function(){d.receivedNewMessage(a,c)})}):this.$FantaTabsSlimApp2(function(){b("ifRequired")("FantaMessageActions",function(d){b("setImmediate")(function(){d.receivedNewMessage(a,c)})})})}.bind(this),c}a.prototype.getPumpedUp=function(a){this.$FantaTabsSlimApp1?a():this.$FantaTabsSlimApp2(a)};a.prototype.silentPumpUp=function(){this.$FantaTabsSlimApp1||this.$FantaTabsSlimApp2(b("emptyFunction"),!0)};a.prototype.getViewComponent=function(a){a=a?b("React").createElement("div",null):b("React").createElement(b("FantaTabMainPlaceholder.react"),null);return b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{loadDataOnMount:!1}),loader:b("JSResource")("FantaMercuryTabsWithMain.react").__setRef("FantaTabsSlimApp"),placeholder:a})};a.prototype.initializeFantaData=function(a){__p&&__p();d(["FantaCookieUtil","MercuryThreadInformer","PresenceState"],function(c,d,e){__p&&__p();b("WorkplaceChatHelper").suppressChatIfActiveOnDesktop()||(e.registerStateLoader(function(d){var e=this;this.$FantaTabsSlimApp1?b("ifRequired")("FantaTabActions",function(e){b("ifRequired")("FantaAppStore",function(b){e.loadFromData(c.convertCookieData(d,b.getState().tabGroup,a))})}):(function(){var f=c.convertCookieData(d,null,a);f&&f.tabs.length>0&&e.$FantaTabsSlimApp2(function(){b("ifRequired")("FantaTabActions",function(a){a.loadFromData(f)})})})()}.bind(this)),e.doSync()),d.get().subscribe("threads-updated",function(a,c){b("ifRequired")("FantaGetMessageActions",function(a){Object.keys(c).forEach(function(c){b("setImmediate")(function(){a.refreshThread(c)})})})}),b("ChatPerfInstrumentation").logInitData()}.bind(this))};a.prototype.$FantaTabsSlimApp2=function(a,c){__p&&__p();b("ifRequired")("FantaAppStore",function(b){a()},function(){d(["FantaAppStore","FantaCookieUtil","FantaMessageActions","FantaTabActions","FantaTabViewportManager","PresenceState"],function(d,e,f,g,i,j){j.registerStateStorer(function(a){var b=d.getState().tabGroup;if(!h||h&&!h.equals(b)){h=b;return e.createCookieData(b,a)}else return a}),b("ReactDOM").render(this.getViewComponent(c),this.tabsElem),i.init(this.tabsElem),this.$FantaTabsSlimApp1=!0,a()}.bind(this))}.bind(this))};a.prototype.initializeFantaUI=function(){d(["FantaMercuryThreadEventsBootloaded","FantaMessageActions","FantaTabActions","FantaTabViewportManager","FBRTCMessageHandler","MercuryBrowserAlerts"],function(a,c,d,e,f,g){f.init(),g.init(),a.onMessagesReceived(this.$FantaTabsSlimApp3),b("ChatPerfInstrumentation").logInitUI(),b("ChatPerfInstrumentation").logDisplayDone()}.bind(this))};e.exports=new a()}),null);
__d("PureStoreBasedStateMixin",["invariant","FluxMixinLegacyInstrumentation","StoreBasedStateMixinHelper","setImmediate"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=function(){__p&&__p();for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];return b("FluxMixinLegacyInstrumentation").addInstrumentation({_callCalculateState:function(){return this.constructor.calculateState()},getInitialState:function(){this._onInitialStateForInstrumentation&&this._onInitialStateForInstrumentation();return this._callCalculateState()},UNSAFE_componentWillMount:function(){__p&&__p();this.constructor.calculateState||g(0);this._recalculateStateID=null;var a=function(){var a=this;this.isMounted()&&(function(){var b=a._collectStoreEmitsForInstrumentation?a._collectStoreEmitsForInstrumentation():null,c=a._callCalculateState();a.setState(a._logStoreEmitsForInstrumentation!=null?function(){b!=null&&this._logStoreEmitsForInstrumentation&&this._logStoreEmitsForInstrumentation(b);return c}.bind(a):c)})();this._recalculateStateID=null}.bind(this);this._mixin=new(b("StoreBasedStateMixinHelper"))(c);this._mixin.subscribeCallback(function(){this._recalculateStateID===null&&(this._recalculateStateID=b("setImmediate")(a))}.bind(this),this._addStoreEmitForInstrumentation)},componentWillUnmount:function(){this._mixin.release(),this._mixin=null}})}.bind(this);e.exports=a}),null);
__d("MNCommerceDialogContainer.react",["MNCommerceDialogStateStore","PureStoreBasedStateMixin","React"],(function(a,b,c,d,e,f){"use strict";a=b("React").createClass({displayName:"MNCommerceDialogContainer",mixins:[b("PureStoreBasedStateMixin")(b("MNCommerceDialogStateStore"))],statics:{calculateState:function(){var a=b("MNCommerceDialogStateStore").getDialogContainer();return{dialogContainer:a}}},render:function(){var a=this.state.dialogContainer;return!a?null:b("React").createElement(a,null)}});e.exports=a}),null);
__d("MNCommerceDialogContainerMount",["MNCommerceDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").createElement(b("MNCommerceDialogContainer.react"),null),a)}};e.exports=a}),null);
__d("FBRTCIceStatsParser",[],(function(a,b,c,d,e,f){__p&&__p();var g=null;h.getInstance=function(){"use strict";g||(g=new h());return g};function h(){"use strict"}h.prototype.extractIceInfo=function(a){"use strict";var b=[];a=a.split("\r\n");for(var c=0;c<a.length;c++){var d=a[c];this.$1(d)&&b.push({gen:this.$2(d),type:this.$3(d)})}return b};h.prototype.$1=function(a){"use strict";return a.indexOf("candidate:")>-1};h.prototype.$2=function(a){"use strict";var b=0;a=a.match(/generation (\d+)/);a&&(b=parseInt(a[1],10));return b};h.prototype.$3=function(a){"use strict";a=a.match(/typ (host|relay|srflx|prflx)/);if(a)return a[1];else return"unknown"};e.exports=h}),null);
__d("FBRTCCallSummary",["FBRTCConstants","FBRTCIceStatsParser","FBRTCLogger","FBRTCUtils","SiteData","UserAgentData","performanceNow"],(function(a,b,c,d,e,f){__p&&__p();var g=5*60*1e3,h={CALL_STARTED:"started",SENT_OFFER:"s_o",RECV_OFFER:"r_o",SENT_OFFER_ACK:"s_oack",RECV_OFFER_ACK:"r_oack",SENT_RETRIED_OFFER:"s_o2",RECV_RETRIED_OFFER:"r_o2",SENT_RETRIED_OFFER_ACK:"s_oack2",RECV_RETRIED_OFFER_ACK:"r_oack2",SENT_PRANSWER:"s_pr",RECV_PRANSWER:"r_pr",NETWORK_READY:"network_ready",SENT_ANSWER:"s_a",RECV_ANSWER:"r_a",SENT_ANSWER_ACK:"s_aack",RECV_ANSWER_ACK:"r_aack",SENT_RETRIED_ANSWER:"s_a2",RECV_RETRIED_ANSWER:"r_a2",SENT_RETRIED_ANSWER_ACK:"s_aack2",RECV_RETRIED_ANSWER_ACK:"r_aack2",SENT_OK:"s_ok",RECV_OK:"r_ok",CALL_CONNECTED:"connected",CALL_ENDED:"ended"},i={FELLBACK_TO_AUDIO:"f_a",MEDIA_REQUESTED:"m_r",MEDIA_SUCCEEDED:"m_s",POPUP_OPENED:"opened",PRESSED_ANSWER:"p_a",TESTER_RETRIES:"t_r"},j={ESCALATION_IS_AVAILABLE:"esc_available",USER_INITIATED_REQUEST:"out_started",RECEIVED_INCOMING_REQUEST:"inc_started",REJECTED_INVALID_P2P_STATE:"rej_invalid_state",CONNECTING_TO_MULTIWAY:"u_connecting_mw",CONNECTED_TO_MULTIWAY:"u_connected_mw",PEER_CONNECTING_TO_MULTIWAY:"p_connecting_mw",PEER_CONNECTED_TO_MULTIWAY:"p_connected_mw",READY_TO_ESCALATE:"ready_esc",PEER_FAILED_TO_CONNECT_TO_MULTIWAY:"p_fail_conn",MULTIWAY_CALL_ENDED:"mw_call_ended",TIMED_OUT:"timed_out",PEER_ABORTED:"p_aborted",INTERNAL_ERROR:"internal_err"},k={ESCALATION_INITIATION_BUTTON_CLICKED:"esc_init_button",ESCALATION_APPROVED_BUTTON_CLICKED:"esc_appr_button",ESCALATION_DECLINED_BUTTON_CLICKED:"esc_decl_button",USERMEDIA_REQUEST:"media_req",USERMEDIA_SUCCESS:"media_success",USERMEDIA_FAILURE:"media_fail",SENT_ESC_REQUEST:"s_esc_req",RECV_ESC_REQUEST:"r_esc_req",SENT_ESC_REQUEST_ACK:"s_esc_req_ack",RECV_ESC_REQUEST_ACK:"s_esc_req_ack",SENT_ESC_RESPONSE:"s_esc_rep",RECV_ESC_ACCEPT:"r_esc_accept",RECV_ESC_DECLINE:"r_esc_decl",RECV_ESC_TIMEOUT:"r_esc_timeout"};function l(a){"use strict";this.peerID=String(a.peerID),this.callID=String(a.callID),this.$1=a.isCaller,this.$2=b("FBRTCUtils").getLocalUploadLogLevel(),this.$13=new Date().valueOf(),this.$3=null,this.$4={},this.$6={},this.$7={},this.$12={},this.$35=null,this.$36=null,this.$37=null,this.$15=0,this.$16=0,this.$34=!1,this.$23={},this.$24={},this.$8={},this.$9={},this.$10={},this.$11={},this.$25=null,this.$18=b("performanceNow")(),this.$14=0,this.$5={},this.$17=this.$18,this.$19=0,this.$20={},this.addExtraInfo(b("FBRTCLogger").Key.DEVICE_INFO,this.$38()),this.$39(),this.$22=b("FBRTCIceStatsParser").getInstance(),this.$21=b("FBRTCLogger").getInstance()}l.prototype.toJsonString=function(){"use strict";this.$16=new Date().valueOf();return JSON.stringify({version:l.CURRENT_SUMMARY_VERSION,peerID:this.peerID,callID:this.callID,isCaller:this.$1,uploadLogLevel:this.$2,clientVersion:this.$25,callType:this.$30,isUsingMultiway:this.$26,conferenceName:this.$28,activeConn:this.$27,escP2PCallID:this.$29,serverInfoData:this.$31,localVideoDuration:this.$32,remoteVideoDuration:this.$33,startTime:this.$13,trigger:this.$3,signalingTime:this.$4,escStateTimes:this.$6,applicationEventTime:this.$7,videoEscTimes:this.$12,endCallReason:this.$35,endCallSubreason:this.$36,isRemoteEnded:this.$37,lastUpdatedTime:this.$15,lastSerializedTime:this.$16,unsetOnRetrieve:this.$34,openCount:this.$19,extraInfo:this.$20,pcStats:this.$23,captureStats:this.$24,gen0IceSentCount:this.$8,gen0IceReceivedCount:this.$9,iceSentCount:this.$10,iceReceivedCount:this.$11,newSignalingTime:this.$5,accumulatedCallTime:this.$40()})};l.fromJsonString=function(a){"use strict";__p&&__p();var b=void 0;try{b=JSON.parse(a)}catch(a){return null}if(b.version!==l.CURRENT_SUMMARY_VERSION)return null;if(!Object.prototype.hasOwnProperty.call(b,"peerID")||!Object.prototype.hasOwnProperty.call(b,"callID")||!Object.prototype.hasOwnProperty.call(b,"isCaller")||!Object.prototype.hasOwnProperty.call(b,"startTime")||!Object.prototype.hasOwnProperty.call(b,"trigger")||!Object.prototype.hasOwnProperty.call(b,"signalingTime")||!Object.prototype.hasOwnProperty.call(b,"endCallReason")||!Object.prototype.hasOwnProperty.call(b,"isRemoteEnded")||!Object.prototype.hasOwnProperty.call(b,"lastUpdatedTime")||!Object.prototype.hasOwnProperty.call(b,"lastSerializedTime"))return null;a=new l({peerID:b.peerID,callID:b.callID,isCaller:b.isCaller});a.$2=b.uploadLogLevel;a.$25=b.clientVersion;a.$13=b.startTime;a.$3=b.trigger;a.$4=b.signalingTime;a.$35=b.endCallReason;a.$36=b.endCallSubreason;a.$37=b.isRemoteEnded;a.$15=b.lastUpdatedTime;a.$16=b.lastSerializedTime;b.callType&&(a.$30=b.callType);b.isUsingMultiway!=null&&(a.$26=b.isUsingMultiway);b.conferenceName&&(a.$28=b.conferenceName);b.escP2PCallID&&(a.$29=b.escP2PCallID);b.activeConn&&(a.$27=b.activeConn);b.serverInfoData&&(a.$31=b.serverInfoData);b.localVideoDuration&&(a.$32=b.localVideoDuration);b.remoteVideoDuration&&(a.$33=b.remoteVideoDuration);b.unsetOnRetrieve&&(a.$34=b.unsetOnRetrieve);b.openCount&&(a.$19=b.openCount);b.extraInfo&&(a.$20=b.extraInfo);b.pcStats&&(a.$23=b.pcStats);b.captureStats&&(a.$24=b.captureStats);b.gen0IceSentCount&&(a.$8=b.gen0IceSentCount);b.gen0IceReceivedCount&&(a.$9=b.gen0IceReceivedCount);b.iceSentCount&&(a.$10=b.iceSentCount);b.iceReceivedCount&&(a.$11=b.iceReceivedCount);b.newSignalingTime&&(a.$5=b.newSignalingTime);b.accumulatedCallTime&&(a.$14=b.accumulatedCallTime);b.escStateTimes&&(a.$6=b.escStateTimes);b.applicationEventTime&&(a.$7=b.applicationEventTime);b.videoEscTimes&&(a.$12=b.videoEscTimes);return a};l.restoreOrInitialize=function(a,c,d,e,f,g){"use strict";c=String(c);d=String(d);a=a.retrieveCallSummary(c,d);!a?(a=new l({peerID:c,callID:d,isCaller:e}),f?(a.onFullMessageReceived({msg:f}),a.onOfferAckSent(f)):a.onCallStarted(g||b("FBRTCLogger").Trigger.UNKNOWN),b("FBRTCLogger").getInstance().logError(c,d,"Missing call summary from storage")):a.$34&&(a.$35=null,a.$36=null,a.$37=null,delete a.$4[h.CALL_ENDED],delete a.$5[h.CALL_ENDED],a.$34=null);return a};l.logSavedSummaries=function(a){"use strict";__p&&__p();var c=a.getLoggableSummaries(),d=c.length;if(d<=0)return;var e=b("FBRTCLogger").getInstance(),f=[];for(var g=0;g<d;g++){var h=c[g];e.logEndCallSummary(h);f.push({peerID:h.peerID,callID:h.callID})}a.removeCallSummaries(f);e.logToConsole("Logged pending summaries: "+d)};l.prototype.save=function(a){"use strict";var c=b("performanceNow")(),d=c-this.$17;if(d>g){this.$21.logInfo(this.peerID,this.callID,"Summary too old: "+d);return}a.storeCallSummary(this.peerID,this.callID,this);this.$17=c};l.prototype.getLastUpdatedTime=function(){"use strict";return this.$15};l.prototype.setLastUpdatedTime=function(a){"use strict";this.$15=a};l.prototype.getExtraInfo=function(){"use strict";return this.$20};l.prototype.getCallTrigger=function(){"use strict";return this.$3};l.prototype.addExtraInfo=function(a,b){"use strict";this.$20[a]=b,this.$39()};l.prototype.isCaller=function(){"use strict";return this.$1};l.prototype.isNetworkReady=function(){"use strict";if(this.$4[h.NETWORK_READY])return!0;else return!1};l.prototype.isAnswerReceived=function(){"use strict";if(this.$4[h.RECV_ANSWER])return!0;else return!1};l.prototype.onCallStarted=function(a){"use strict";this.$3=a,this.$41(h.CALL_STARTED),this.$39()};l.prototype.onPopupOpened=function(){"use strict";this.$42(i.POPUP_OPENED),this.$19++,this.$39()};l.prototype.onPressedAnswer=function(){"use strict";this.$42(i.PRESSED_ANSWER),this.$39()};l.prototype.onMediaRequested=function(){"use strict";this.$42(i.MEDIA_REQUESTED),this.$39()};l.prototype.onMediaSucceeded=function(){"use strict";this.$42(i.MEDIA_SUCCEEDED),this.$39()};l.prototype.onFellbackToAudio=function(){"use strict";this.$42(i.FELLBACK_TO_AUDIO),this.$39()};l.prototype.setTesterRetries=function(a){"use strict";this.$7[i.TESTER_RETRIES]=a,this.$39()};l.prototype.setPcStats=function(a){"use strict";this.$23=a,this.$39()};l.prototype.setVideoCaptureStats=function(a,b){"use strict";this.$24={w:a,h:b},this.$39()};l.prototype.setVideoCaptureConstraints=function(a){"use strict";this.$24=a,this.$39()};l.prototype.setUploadLogLevel=function(a){"use strict";this.$2=a,this.$39()};l.prototype.getCallType=function(){"use strict";return this.$30};l.prototype.setCallType=function(a){"use strict";this.$30=a,this.addExtraInfo("call_type",a),this.$39()};l.prototype.setVideoDurations=function(a,b){"use strict";this.$32=a,this.$33=b,this.$39()};l.prototype.setScreenDuration=function(a){"use strict";this.addExtraInfo(b("FBRTCLogger").Key.SCREEN_DURATION,a)};l.prototype.setIsUsingMultiway=function(a){"use strict";this.$26=a,this.$39()};l.prototype.setConferenceName=function(a){"use strict";this.$28=a,this.$39()};l.prototype.setServerInfoData=function(a){"use strict";this.$31=a,this.$39()};l.prototype.setActiveConnection=function(a){"use strict";this.$27=a,this.$39()};l.prototype.setEscalationP2PCallID=function(a){"use strict";this.$29=a,this.$39()};l.prototype.onOfferAckSent=function(a){"use strict";this.onMessageSent({type:b("FBRTCConstants").PayloadType.OFFER_ACK,flag:a.flag})};l.prototype.onMessageSent=function(a){"use strict";__p&&__p();var c=a.flag===1;switch(a.type){case b("FBRTCConstants").PayloadType.OFFER:this.$43(c,h.SENT_OFFER,h.SENT_RETRIED_OFFER);this.$44(a,this.$8,this.$10);break;case b("FBRTCConstants").PayloadType.ANSWER:this.$43(c,h.SENT_ANSWER,h.SENT_RETRIED_ANSWER);this.$44(a,this.$8,this.$10);break;case b("FBRTCConstants").PayloadType.OK:this.$41(h.SENT_OK);break;case b("FBRTCConstants").PayloadType.PRANSWER:this.$41(h.SENT_PRANSWER);break;case b("FBRTCConstants").PayloadType.OFFER_ACK:this.$43(c,h.SENT_OFFER_ACK,h.SENT_RETRIED_OFFER_ACK);break;case b("FBRTCConstants").PayloadType.ANSWER_ACK:this.$43(c,h.SENT_ANSWER_ACK,h.SENT_RETRIED_ANSWER_ACK);break;case b("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$44(a,this.$8,this.$10);break;case b("FBRTCConstants").PayloadType.ACK:a.ack_type===b("FBRTCConstants").PayloadType.VIDEO_REQUEST&&this.$45(k.SENT_ESC_REQUEST_ACK);break;case b("FBRTCConstants").PayloadType.VIDEO_REQUEST:a.ack_id?this.$45(k.SENT_ESC_RESPONSE):this.$45(k.SENT_ESC_REQUEST);break;default:}this.$39()};l.prototype.$44=function(a,b,c){"use strict";var d,e=null;a=this.$22.extractIceInfo(a.sdp);for(var f=0;f<a.length;f++)d=a[f].gen,e=a[f].type,d===0&&this.$46(b,e),this.$46(c,e)};l.prototype.$46=function(a,b){"use strict";!a[b]?a[b]=1:a[b]=a[b]+1};l.prototype.$47=function(a){"use strict";this.addExtraInfo(b("FBRTCLogger").Key.PEER_IS_MOBILE,a.isFromMobile()?"1":"0")};l.prototype.onFullMessageReceived=function(a){"use strict";__p&&__p();var c=a.msg,d=c.flag===1;switch(c.type){case b("FBRTCConstants").PayloadType.OFFER:this.$47(a);this.$43(d,h.RECV_OFFER,h.RECV_RETRIED_OFFER);this.$44(c,this.$9,this.$11);break;case b("FBRTCConstants").PayloadType.ANSWER:this.$47(a);this.$43(d,h.RECV_ANSWER,h.RECV_RETRIED_ANSWER);this.$44(c,this.$9,this.$11);break;case b("FBRTCConstants").PayloadType.OK:this.$41(h.RECV_OK);break;case b("FBRTCConstants").PayloadType.PRANSWER:this.$41(h.RECV_PRANSWER);break;case b("FBRTCConstants").PayloadType.OFFER_ACK:this.$43(d,h.RECV_OFFER_ACK,h.RECV_RETRIED_OFFER_ACK);break;case b("FBRTCConstants").PayloadType.ANSWER_ACK:this.$43(d,h.RECV_ANSWER_ACK,h.RECV_RETRIED_ANSWER_ACK);break;case b("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$44(c,this.$9,this.$11);break;case b("FBRTCConstants").PayloadType.ACK:c.ack_type===b("FBRTCConstants").PayloadType.VIDEO_REQUEST&&this.$45(k.RECV_ESC_REQUEST_ACK);break;case b("FBRTCConstants").PayloadType.VIDEO_REQUEST:c.ack_id?c.videoon||c.reqVideoOn?this.$45(k.RECV_ESC_ACCEPT):this.$45(k.RECV_ESC_DECLINE):c.videoon||c.reqVideoOn?this.$45(k.RECV_ESC_REQUEST):this.$45(k.RECV_ESC_TIMEOUT);default:}this.$39()};l.prototype.onMsgAckReceived=function(a,b){"use strict";a=a.msg.flag===1;b?this.$43(a,h.RECV_OFFER_ACK,h.RECV_RETRIED_OFFER_ACK):this.$43(a,h.RECV_ANSWER_ACK,h.RECV_RETRIED_ANSWER_ACK)};l.prototype.onNetworkReady=function(){"use strict";this.$41(h.NETWORK_READY),this.$39()};l.prototype.onCallConnected=function(){"use strict";this.$41(h.CALL_CONNECTED),this.$39()};l.prototype.onCallEnded=function(a,b,c,d){"use strict";this.$34=c,this.$35=String(a),this.$36=d,this.$37=b,this.$41(h.CALL_ENDED),this.$39()};l.prototype.setOfferSentTime=function(){"use strict";this.$41(h.SENT_OFFER)};l.prototype.setOfferAckReceivedTime=function(){"use strict";this.$41(h.RECV_OFFER_ACK)};l.prototype.setAnswerSentTime=function(){"use strict";this.$41(h.SENT_ANSWER)};l.prototype.setAnswerReceivedTime=function(){"use strict";this.$41(h.RECV_ANSWER)};l.prototype.setEscalationAvailable=function(){"use strict";this.$48(j.ESCALATION_IS_AVAILABLE)};l.prototype.setEscalationInitiated=function(){"use strict";this.$48(j.USER_INITIATED_REQUEST)};l.prototype.setReceivedEscalationRequest=function(){"use strict";this.$48(j.RECEIVED_INCOMING_REQUEST)};l.prototype.setInvalidP2PEscalationState=function(){"use strict";this.$48(j.REJECTED_INVALID_P2P_STATE)};l.prototype.setEscalationConnectingToMultiway=function(){"use strict";this.$48(j.CONNECTING_TO_MULTIWAY)};l.prototype.setEscalationConnectedToMultiway=function(){"use strict";this.$48(j.CONNECTED_TO_MULTIWAY)};l.prototype.setEscalationPeerConnectingToMultiway=function(){"use strict";this.$48(j.PEER_CONNECTING_TO_MULTIWAY)};l.prototype.setEscalationPeerConnectedToMultiway=function(){"use strict";this.$48(j.PEER_CONNECTED_TO_MULTIWAY)};l.prototype.setReadyToEscalate=function(){"use strict";this.$48(j.READY_TO_ESCALATE)};l.prototype.setEscalationPeerFailedToConnectToMultiway=function(){"use strict";this.$48(j.PEER_FAILED_TO_CONNECT_TO_MULTIWAY)};l.prototype.setEscalationTimedOut=function(){"use strict";this.$48(j.TIMED_OUT)};l.prototype.setVidEscalationInitClick=function(){"use strict";this.$45(k.ESCALATION_INITIATION_BUTTON_CLICKED)};l.prototype.setVidEscalationAcceptedClick=function(){"use strict";this.$45(k.ESCALATION_APPROVED_BUTTON_CLICKED)};l.prototype.setVidEscalationDeclinedClick=function(){"use strict";this.$45(k.ESCALATION_DECLINED_BUTTON_CLICKED)};l.prototype.setVidEscalationMediaRequested=function(){"use strict";this.$45(k.USERMEDIA_REQUEST)};l.prototype.setVidEscalationMediaSuccess=function(){"use strict";this.$45(k.USERMEDIA_SUCCESS)};l.prototype.setVidEscalationMediaFailed=function(){"use strict";this.$45(k.USERMEDIA_FAILURE)};l.prototype.toString=function(){"use strict";var a={};a.core_metrics=this.$49();a.time_series=null;return JSON.stringify(a)};l.prototype.$49=function(){"use strict";__p&&__p();var a={};a.ver=l.CURRENT_SUMMARY_VERSION;a.log_level=b("FBRTCConstants").uploadLogLevelString(this.$2);a.caller=this.$1;a.call_type=this.$30;a.is_using_multiway=this.$26;a.active_conn=this.$27;a.app_event_times=this.$7;a.conf_name=this.$28;a.esc_p2p_call_id=this.$29;a.esc_state_times=this.$6;a.vid_esc_times=this.$12;a.serv_info=this.$31;a.conn=this.$50();a.peer_id=this.peerID;a.has_video=!0;a.open_count=this.$19;a.signaling=this.$51();a.sender=this.$52();a.receiver=this.$53();a.end=this.$54();a.video=this.$55();a.push_phase=b("SiteData").push_phase;a.client_version=this.$25;return a};l.prototype.$50=function(){"use strict";var a={dtls:1};this.$23.sender&&this.$23.sender.rtt&&(a.rtt=this.$23.sender.rtt);return a};l.prototype.$51=function(){"use strict";__p&&__p();var a={};this.$3&&(a.trigger=this.$3);a.start_time=this.$13;a.time_from_start=this.$4;a.new_time_from_start=this.$5;var b=this.$5[h.CALL_CONNECTED],c=this.$5[h.CALL_ENDED];if(b){c||(this.$14>0?c=this.$14:c=this.$40());c=c-b;c>0&&(a.duration=c)}return a};l.prototype.$52=function(){"use strict";var a={};this.$8&&(a.ice_g0=this.$8);this.$10&&(a.ice=this.$10);this.$23.sender&&Object.assign(a,this.$23.sender);return a};l.prototype.$53=function(){"use strict";var a={};this.$9&&(a.ice_g0=this.$9);this.$11&&(a.ice=this.$11);return a};l.prototype.$54=function(){"use strict";var a={};this.$35!==null&&(a.end_call_reason_string=b("FBRTCConstants").callEndReasonString(this.$35),this.$36!==null&&(a.end_call_subreason_string=this.$36),a.remote_ended=this.$37);this.$23.end&&Object.assign(a,this.$23.end);return a};l.prototype.$55=function(){"use strict";var a={capture:{}};this.$23.video&&this.$23.video.sender&&Object.assign(a,this.$23.video.sender);this.$24&&Object.assign(a.capture,this.$24);return{sender:a,ld:this.$32,rd:this.$33}};l.prototype.$56=function(){"use strict";return new Date().valueOf()-this.$13};l.prototype.$40=function(){"use strict";var a=b("performanceNow")()-this.$18;return Math.floor(this.$14+a)};l.prototype.$41=function(a){"use strict";if(this.$4[a])return;this.$4[a]=this.$56();this.$5[a]=this.$40()};l.prototype.$48=function(a){"use strict";if(this.$6[a])return;this.$6[a]=this.$56()};l.prototype.$42=function(event){"use strict";if(this.$7[event])return;this.$7[event]=this.$56()};l.prototype.$45=function(event){"use strict";if(this.$12[event])return;this.$12[event]=this.$56()};l.prototype.$43=function(a,b,c){"use strict";a?this.$41(c):this.$41(b)};l.prototype.$39=function(){"use strict";this.$15=new Date().valueOf()};l.prototype.$38=function(){"use strict";return{device:b("UserAgentData").deviceName,os:b("UserAgentData").platformName,os_version:b("UserAgentData").platformFullVersion,browser:b("UserAgentData").browserName,browser_version:b("UserAgentData").browserFullVersion,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth}};l.prototype.setClientVersion=function(a){"use strict";this.$25=a};l.prototype.getCallDuration=function(){"use strict";var a=this.$51();return a.duration?a.duration:0};l.prototype.getConnectedStartTime=function(){"use strict";return this.$4[h.CALL_CONNECTED]?this.$4[h.CALL_CONNECTED]+this.$13:0};l.CURRENT_SUMMARY_VERSION=19;e.exports=l}),null);
__d("FBRTCCallSummaryStore",["CacheStorage","FBRTCCallSummary","FBRTCLogger","areEqual"],(function(a,b,c,d,e,f){__p&&__p();var g="localstorage",h="RTC_CALL_SUMMARY_",i="summary",j=2e3,k=3,l=3*60*1e3,m=null;n.getInstance=function(){"use strict";m||(m=new n());return m};function n(){"use strict";this.$1=new(b("CacheStorage"))(g,h),this.$2=b("FBRTCLogger").getInstance()}n.prototype.storeCallSummary=function(a,b,c){"use strict";__p&&__p();var d=this;this.$3(function(e){__p&&__p();e[a]||(e[a]={});var f=e[a][b];if(f){f=d.$4(f);if(f&&f.getLastUpdatedTime()>c.getLastUpdatedTime()){d.$2.logToConsole("Outdated summaries");return null}}e[a][b]=d.$5(c);return e},d.$2.logError.bind(d.$2,a,b))};n.prototype.retrieveCallSummary=function(a,b){"use strict";var c=this.$6(),d=null;c[a]&&(d=c[a][b]);if(d)return this.$4(d);else return null};n.prototype.removeCallSummary=function(a,b){"use strict";this.removeCallSummaries([{peerID:a,callID:b}])};n.prototype.removeCallSummaries=function(a){"use strict";var b=this;this.$3(function(c){var d=a.length;for(var e=0;e<d;e++){var f=a[e].peerID,g=a[e].callID;c[f]&&c[f][g]&&(delete c[f][g],b.$7(c[f])&&delete c[f])}return c},b.$2.logError.bind(b.$2,null,null))};n.prototype.getLoggableSummaries=function(){"use strict";__p&&__p();var a=this.$6(),b=[];for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c))for(var d in a[c])if(Object.prototype.hasOwnProperty.call(a[c],d)){var e=this.$4(a[c][d],l);e&&b.push(e)}return b};n.prototype.$7=function(a){"use strict";for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0};n.prototype.$5=function(a){"use strict";a={__t:Date.now(),__d:a.toJsonString()};return a};n.prototype.$4=function(a,c){"use strict";return a&&(!c||Date.now()-a.__t>=c)?b("FBRTCCallSummary").fromJsonString(a.__d):null};n.prototype.$6=function(){"use strict";var a=this.$1.get(i)||{};return a};n.prototype.$3=function(a,c,d,e){__p&&__p();var f=this;(d===undefined||d===null)&&(d=k);var g=this.$6(),h=this.$6();g=a(g);if(g===null)return;var l=this.$6();b("areEqual")(h,l)?(this.$1.set(i,g),this.$2.logToConsole("Updated summaries")):d>0?(c("Retry lock"),e?function(){var b=f;setTimeout(function(){b.$3(a,c,d-1,!0)},j)}():this.$3(a,c,d-1,!0)):c("Failed to lock")};e.exports=n}),null);
__d("FBRTCCallSummaryUploader",["Banzai","FBRTCCallSummary","FBRTCCallSummaryStore"],(function(a,b,c,d,e,f){a={init:function(){var a=b("FBRTCCallSummaryStore").getInstance();b("Banzai").subscribe(b("Banzai").SEND,function(){b("FBRTCCallSummary").logSavedSummaries(a)})}};e.exports=a}),null);
__d("NotificationJewelReminderLoader",["promiseDone"],(function(a,b,c,d,e,f){e.exports={init:function(a,c){b("promiseDone")(a.load(),function(a){a.init(c)})}}}),null);
__d("P2PDialogStore",["EventEmitter","P2PActionConstants","P2PDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;void 0;var h={};c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(){g.constructor.call(this),b("P2PDispatcher").register(this.onEventDispatched.bind(this)),h={dialogClass:null,dialogProps:null}}a.prototype.getState=function(){return h};a.prototype.onEventDispatched=function(a){__p&&__p();var c=a.type;a=a.data;switch(c){case b("P2PActionConstants").DIALOG_SHOWN:h.dialogClass=a.dialogClass;h.dialogProps=a.dialogProps;this.emit("change");break;case b("P2PActionConstants").DIALOG_CLOSED:h.dialogClass=null;h.dialogProps=null;this.emit("change");break}};e.exports=new a()}),null);
__d("P2PDialogContainer.react",["P2PDialogStore","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.state=b("P2PDialogStore").getState(),this.onDialogStoreChange=function(){this.setState(b("P2PDialogStore").getState())}.bind(this),c}a.prototype.componentDidMount=function(){this.dialogStoreSub=b("P2PDialogStore").addListener("change",this.onDialogStoreChange)};a.prototype.componentWillUnmount=function(){this.dialogStoreSub&&(this.dialogStoreSub.remove(),this.dialogStoreSub=null)};a.prototype.render=function(){if(!this.state.dialogClass)return null;var a=this.state.dialogClass;return b("React").createElement(a,babelHelpers["extends"]({},this.state.dialogProps,{key:"dialog"}))};e.exports=a}),null);
__d("P2PDialogContainerMount",["P2PDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").createElement(b("P2PDialogContainer.react"),null),a)}};e.exports=a}),null);
__d("PagesPlatformActionConstants",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({BOOKING_REQUEST_ACCEPT_ERROR:"booking_request_accept_error",BOOKING_REQUEST_ACCEPT_INITIATED:"booking_request_accept_initiated",BOOKING_REQUEST_ACCEPTED:"booking_request_accepted",BOOKING_REQUEST_CREATED:"booking_request_created",BOOKING_REQUEST_DECLINE_ERROR:"booking_request_decline_error",BOOKING_REQUEST_DECLINE_INITIATED:"booking_request_decline_initiated",BOOKING_REQUEST_DECLINED:"booking_request_declined",BOOKING_REQUEST_RESCHEDULE_INITIATED:"booking_request_reschedule_initiated",BOOKING_REQUEST_RESCHEULED:"booking_request_reschedule",DIALOG_CLOSED:"dialog_closed",DIALOG_SHOWN:"dialog_shown",NEW_TIME_CHOSEN:"new_time_chosen"});e.exports=a}),null);
__d("PagesPlatformRequestDispatcher",["Dispatcher_DEPRECATED"],(function(a,b,c,d,e,f){"use strict";e.exports=new(b("Dispatcher_DEPRECATED"))()}),null);
__d("PagesPlatformDialogStore",["EventEmitter","PagesPlatformActionConstants","PagesPlatformRequestDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h={};c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(){g.constructor.call(this),b("PagesPlatformRequestDispatcher").register(this.onEventDispatched.bind(this)),h={dialogClass:null,dialogProps:null}}a.prototype.getState=function(){return h};a.prototype.onEventDispatched=function(a){__p&&__p();var c=a.type;a=a.data;switch(c){case b("PagesPlatformActionConstants").DIALOG_SHOWN:h.dialogClass=a.dialogClass;h.dialogProps=a.dialogProps;this.emit("change");break;case b("PagesPlatformActionConstants").DIALOG_CLOSED:h.dialogClass=null;h.dialogProps=null;this.emit("change");break}};e.exports=new a()}),null);
__d("PagesPlatformDialogContainer.react",["PagesPlatformDialogStore","PureStoreBasedStateMixin","React"],(function(a,b,c,d,e,f){"use strict";a=b("React").createClass({displayName:"PagesPlatformDialogContainer",mixins:[b("PureStoreBasedStateMixin")(b("PagesPlatformDialogStore"))],statics:{calculateState:function(){return b("PagesPlatformDialogStore").getState()}},render:function(){if(!this.state.dialogClass)return null;var a=this.state.dialogClass;return b("React").createElement(a,babelHelpers["extends"]({},this.state.dialogProps,{key:"dialog"}))}});e.exports=a}),null);
__d("PagesPlatformDialogContainerMount",["PagesPlatformDialogContainer.react","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";a={mount:function(a){b("ReactDOM").render(b("React").createElement(b("PagesPlatformDialogContainer.react"),null),a)}};e.exports=a}),null);
__d("LiveMessageReceiver",["Arbiter","ChannelConstants","emptyFunction","shield"],(function(a,b,c,d,e,f){__p&&__p();function g(a){this.eventName=a,this.subs=null,this.handler=b("emptyFunction"),this.shutdownHandler=null,this.registered=!1,this.appId=1}Object.assign(g,{getAppMessageType:function(a,b){return"live_message/"+a+":"+b},route:function(a){var c=function(c){var d=g.getAppMessageType(a.app_id,a.event_name);b("Arbiter").inform(d,c,b("Arbiter").BEHAVIOR_PERSISTENT)};c(a.response)}});Object.assign(g.prototype,{setAppId:function(a){this.appId=a;return this},setHandler:function(a){this.handler=a;this._dirty();return this},setRestartHandler:b("emptyFunction"),setShutdownHandler:function(a){this.shutdownHandler=b("shield")(a);this._dirty();return this},_dirty:function(){this.registered&&(this.unregister(),this.register())},register:function(){var a=function(a,b){return this.handler(b)}.bind(this),c=g.getAppMessageType(this.appId,this.eventName);this.subs={};this.subs.main=b("Arbiter").subscribe(c,a);this.shutdownHandler&&(this.subs.shut=b("Arbiter").subscribe(b("ChannelConstants").ON_SHUTDOWN,this.shutdownHandler));this.registered=!0;return this},unregister:function(){if(!this.subs)return this;for(var a in this.subs)this.subs[a]&&this.subs[a].unsubscribe();this.subs=null;this.registered=!1;return this}});e.exports=g}),null);
__d("initLiveMessageReceiver",["Arbiter","ChannelConstants","LiveMessageReceiver"],(function(a,b,c,d,e,f){b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("app_msg"),function(a,c){b("LiveMessageReceiver").route(c.obj)})}),null);