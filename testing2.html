<html>
	<head>
		<link href="https://fonts.googleapis.com/css?family=Open+Sans|Permanent+Marker" rel="stylesheet">

	</head>
<style type="text/css">
body {
  background: #000;
}
canvas {
		position: absolute;
     width: 100%;
     height: 100%;
}
	audio{
		position: absolute;
		z-index: 2;
	}
	#whatsapp1 {
		position: absolute;
		left: 60%;
		width: 30%;
		z-index: 3;
		color: azure;
		font: 30px arial;
	}

</style>

<body>
<canvas height="1334px" width="750px" id="c1"></canvas>
<audio controls autoplay id="audio1">
  <source src="ncs3.mp3" type="audio/mpeg">
Your browser does not support the audio element.
</audio>	
<a id="whatsapp1" href="whatsapp://send?text=https://en.wikipedia.org/wiki/Birthday-number_effect" data-action="share/whatsapp/share">Share via Whatsapp</a>
	
</body>
	
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	
<script src="spinner.js"></script>
	
  <script type="text/javascript">

     var canvas = document.getElementById("c1");
    var ctx = canvas.getContext("2d");    
	  
var back1 = new Image();
back1.src = 'img_tuna.jpg';

var smoke = new Image();
smoke.onerror = function() { console.log("error " + this.src);}
smoke.onload = function() { console.log("load " + this.src);}
//smoke.src = 'http://s4.postimg.org/atxdou6u1/smoke.png';
	

function Emitter(opts) {
	this.opts = opts;
	this.particles = [];
	for(var c = 0; c < opts.particles; c++){
     	this.particles.push(new Particle(opts));
  	}
}
	  
Emitter.prototype.render = function(ctx) {
//      ctx.clearRect(0, 0, ctx.width, ctx.height);
	  

    this.particles.forEach(function(particle){
      particle.update();
		particle.render(ctx);
    });
    
}
	

function Particle(opts) {
	this.opts = opts;
//    var x, y, size, speedX, speedY, opacity;
    this.reset();
}
	
Particle.prototype.update = function(){
      if(this.opacity > 0){
        this.opacity -= (Math.random() / this.opts.speed.fade);
//        this.opacity -= 0.005;
      }

      if(this.opacity <= 0.0){
//		  this.y = 300;
         this.reset();
		  /*
		  opacity = 0.09;
		  x=0;
		  y= 0;
		  size=200;
		  */
		  
      }
      this.speedY += 0.001;
	
      this.speedX -= Math.random() / this.opts.speed.acceleration;
      this.speedY -= Math.random() / this.opts.speed.acceleration;
      this.x += this.speedX;
      this.y += this.speedY;
      this.size += Math.random();
      
}

Particle.prototype.render = function(ctx){
	
     ctx.globalAlpha = this.opacity;
     ctx.drawImage(smoke, 0, 0, this.opts.size, this.opts.size, this.x, this.y, this.size, this.size);
	ctx.globalAlpha = 1;
}

var prevCt;
Particle.prototype.reset = function(){
      this.x = this.opts.x;
      this.y = this.opts.y;
      this.size = this.opts.size;
      this.speedX = Math.random() * this.opts.speed.x;
      this.speedY = Math.random() * this.opts.speed.y;
      this.opacity = Math.random();
	
//	console.log(+new Date() - prevCt);
//	prevCt = +new Date();
}

var bAudioPlay = false;
var spinner1 = new Spinner();
var spinner2 = new Spinner();
var spinner3 = new Spinner();
var spinner4 = new Spinner();
	  
var spinner5 = new Spinner(1);
spinner5.x = 350;
spinner5.y = 800;
	  
//var audio = new Audio('ncs1.mp3');
var audio = document.getElementById("audio1");
	  
//audio.play();
audio.onended = function() {
	audio.play();
}
var i = 0;
audio.ontimeupdate = function() {
	
}
audio.onpause = function() {console.log("pause"); bAudioPlay = false;  }
audio.onplay = function() { console.log("play");  bAudioPlay = true; }
console.log('setup events');
	  
	  if (true) {
var emitter = new Emitter({
  x: -200,
  y: 50,
  size: 100,
  particles: 200,
  speed: {
    x: 2.5,
    y: 1,
    fade: 350,
    acceleration: 300
  }
});
var emitter2 = new Emitter({
  x: -300,
  y: 550,
  size: 100,
  particles: 200,
  speed: {
    x: 2.5,
    y: 1,
    fade: 350,
    acceleration: 300
  }
});
	  }
	  
	  var myPalette = new function() {
		  
		  this.randColor = function() {
			  var i = Math.floor(Math.random() * 4);
			  
			  switch (i) {
				  case 0: c = "#FFAA88"; break;
				  case 1: c = "#FFFF88"; break;
				  case 2: c = "#AAAAFF"; break;
				  case 3: c = "#FF88AA"; break;
					 }
			  
			  return c;
		  }
	  }();
	  
	  var title1 = {
		  text : 'Scott',
		  digit: 10,
		  timer: 800,
		  action: function (elapsed) {
			 this.timer -= elapsed;
			  if (this.timer < 0) {
				  this.timer = 400;
				  this.text = this.digit--;
				  
			  }
		  },
		  render: function(ctx) {
//			  ctx.font="bold 20px helvetica";
			  ctx.font="50px Permanent Marker";
			  ctx.fontFamily = "Permanent Marker";
			  ctx.fillStyle = "#224422";
			  ctx.fillText(this.text,7,28);  
			  ctx.fillText(canvas.height,7,52);  
			 
		  }
	  }
	  var checkBox = {
		  action: function () {
			  	
		  },
		  render: function(ctx) {
			  ctx.strokeStyle = "#447744";
			  ctx.lineWidth = 6;
			  ctx.beginPath();
			  ctx.moveTo(127,127);
			  ctx.lineTo(140,140);
			  ctx.stroke();
			  ctx.beginPath();
			  ctx.moveTo(127,140);
			  ctx.lineTo(140,127);
			  ctx.stroke();
		  }
	  }
	  
	  function roundedBox(ctx, x, y, width, height) {
		  var radius=width * 0.12;
		  ctx.beginPath();
		  ctx.moveTo(x+radius,y);
		  
		  ctx.lineTo(x+width-radius,y);
		  ctx.arcTo(x+width,y,  x+width,y+radius,radius);
		  
		  ctx.lineTo(x+width,y+height-radius);
		  ctx.arcTo(x+width,y+height,  x+width-radius,y+height,radius);
		  
		  ctx.lineTo(x+radius,y+height);
		  ctx.arcTo(x,y+height,  x,y+height-radius,radius);
		  
		  ctx.lineTo(x,y+radius);
		  ctx.arcTo(x,y,  x+width+radius,y,radius);
		  
		  ctx.closePath();
		  ctx.fill();
	  }
	  
	  var gObjs = [];
	  function Star(x,y,dx,dy,lifetime=0) {
		  this.x = x;
		  this.y = y;
		  this.dx = dx;
		  this.dy = dy;
		  this.timer = 0;
		  this.lifetime = lifetime;
		  this.image = new Image();
		  var n = Math.floor(Math.random() * 4);
		  if (n== 0) this.image.src = "https://s3-us-west-2.amazonaws.com/s.cdpn.io/53148/neon-star1.png";
		  if (n== 1) this.image.src = "https://s3-us-west-2.amazonaws.com/s.cdpn.io/53148/neon-star2.png";
		  if (n== 2) this.image.src = "https://s3-us-west-2.amazonaws.com/s.cdpn.io/53148/neon-star3.png";
		  if (n== 3) this.image.src = "https://s3-us-west-2.amazonaws.com/s.cdpn.io/53148/neon-star4.png";
		  
		  this.action = function(elapsed){
			  this.x = this.x + this.dx;
			  this.y = this.y + this.dy;
			  this.timer += elapsed;
		  }
		  this.render = function(ctx) {
//			  ctx.filleStyle = "yellow";
//			  ctx.fillRect(this.x, this.y, 10, 10)
			  if (this.lifetime && this.timer > this.lifetime - 600) {
				  ctx.globalAlpha = Math.max(0,this.lifetime - this.timer) / 600;
			  } else {
				   ctx.globalAlpha = 1;
			  }
			  ctx.filter = 'hue-rotate((200)';
			  ctx.shadowBlur = 10;
			  ctx.shadowColor = "#ffffff"
			  ctx.drawImage(this.image,this.x,this.y);
		  }
	  }
	  
	  function StarShooter(x,y) {
		  this.x = x;
		  this.y = y;
		  
		  this.stars = 10;
		  this.timer = 800;
		  this.action = function(elapsed){
			  this.timer -= elapsed;
			  if (this.timer < 0) {
				  if (this.stars > 0) {
				  gObjs.push(new Star(this.x, this.y, 0, -10,10000))
				  this.stars--;
				  }
				  this.timer = 800;
			  }
		  }
		  this.render = function(ctx) {
			  ctx.fillStyle = "blue";
			  ctx.fillRect(this.x, this.y - this.stars * 10,  80, this.stars * 10);
		  }
	  }
	  
	  gObjs.push(new StarShooter(100,1200));
	  gObjs.push(new StarShooter(300,1200));
	  
	  function Polygon () {
		  this.x = Math.random() * 700;
		  this.y = Math.random() * 500;
		  this.y = 100;
		  this.dx = Math.random() * 0.2 - 0.1;
		  this.dy = Math.random() * 0.2 - 0.1;
		  this.degree= Math.random() * 6.28;
		  this.ddegree = -0.01 + Math.random() * 0.02;
		  this.width = 150;
		  this.height = 150;
		  this.color = myPalette.randColor();
		  this.timer = 499;
		  this.scale = 0;
		  this.dscale = 0;
		  this.tscale = 1;
		  this.myObjs= [];
		  
		  this.action = function(elapsed) {
			  this.degree += this.ddegree;
			  if (this.degree > 6.28) this.degree -= 6.28;
			  this.timer -= elapsed;
			  
			  if (this.timer < 50) this.tscale = 0;
			  
			  if (this.scale != this.tscale) {
				  this.dscale += (this.tscale - this.scale) * 0.03;
					this.dscale *= 0.85;
				  if ((this.tscale == 0) && (this.dscale > 0)) {
					  this.dscale = 0; 
				  }
			  }
			  this.dy += elapsed * 0.5 - this.dy * this.dy * 0.01;
			  this.scale += this.dscale;
			  this.x += this.dx;
			  this.y += this.dy;
			  for (k in this.myObjs) this.myObjs[k].action(elapsed);
		  }
		  
		  this.render = function(ctx) {
			  ctx.save();
//			  ctx.shadowBlur = 3;
//			  ctx.shadowColor = '#888888';
			  ctx.fillStyle = this.color;
			   ctx.translate(this.x, this.y);
				ctx.rotate (this.degree);
			  ctx.transform(this.scale, 0, 0, this.scale, 0, 0);
//				ctx.fillRect(this.width*-0.5, this.height*-0.5, this.width, this.height);
			   roundedBox(ctx, this.width*-0.5, this.height*-0.5, this.width, this.height);
			  
			  ctx.shadowBlur = 0;
			  ctx.translate(this.width*-0.5, this.height*-0.5);
			  for (k in this.myObjs) this.myObjs[k].render(ctx);
			  ctx.restore();
		  }
		  this.touched = function() {
			  this.dx += 20 * (Math.random() < 0.4 ? -1 : 1);
			  gScore += 10;
		  }
	  }
	  var myPoly = new function() {
		  this.timer = 99;
		  this.objs = [];
		  this.objs.push(new Polygon());
		  this.objs.push(new Polygon());
		  this.objs.push(new Polygon());
		  this.objs.push(new Polygon());
		  
		  this.objs[0].myObjs.push(title1);
		  this.objs[0].myObjs.push(checkBox);
		  
		  
		  this.action = function(elapsed)  {
			  let zzz = 99;
			  for(let k in this.objs){
				  this.objs[k].action(1);
				  if (this.objs[k].timer < 0) this.objs.splice(k,1);
			  }
			  this.timer -= elapsed;
			  if (this.timer < 0) {
				  var objx = new Polygon()
				  objx.myObjs.push(title1);
				  
				  objx.myObjs.push(checkBox);
				  this.objs.push(objx);
				  this.timer = 2599 * Math.random();
			  }
		  }
		  this.render = function(ctx) {
			  for(let k in this.objs){
				  this.objs[k].render(ctx);
			  }
		  }
	  } ();

	  var gScore = 0;
	  var q1 = new Polygon();
	  q1.width = 250;
	  q1.height = 100;
	  var title2 = Object.assign({},title1); title2.text = "Who is Gaius?";
	  q1.myObjs.push(title2);
	  myPoly.objs.push(q1);
	  
	  var prevAnimCt=0, animAvg=0;
	  function AnimLoop() {
		  var animCt = +new Date();
		  var elapsed = animCt - prevAnimCt;
		  ctx.save();
		  		  ctx.setTransform(1,0,0,1,0,0)

		  	ctx.fillStyle = 'brown';
    		ctx.fillRect(0, 0, 700, 700);
//back1.height
		  ctx.transform(canvas.width/back1.width,0,0,canvas.height / back1.height,0,0);
		  ctx.drawImage(back1, 0 ,0);
		  ctx.setTransform(1,0,0,1,0,0)
		  emitter.render(ctx);
		  emitter2.render(ctx);
		  
		  
//		  myPaula(ctx);
		  myPoly.action(elapsed);
		  myPoly.render(ctx);
		  
		  for (let n = 0; n < gObjs.length; n++) {
			  let obj = gObjs[n];
			  if (obj.lifetime && obj.timer > obj.lifetime) {
				  gObjs.splice(n, 1);
			  }
		  }
		  
		  ctx.restore();
		  
		  gObjs.forEach((obj)=>{obj.action(elapsed)});
//		  gObjs.forEach((obj)=>{obj.render(ctx)});
		  for(let k in gObjs){
			  gObjs[k].render(ctx);
		  }
		  
		  if (prevAnimCt > 0) animAvg = (animCt - prevAnimCt) * 0.01 + animAvg * 0.99;
		  prevAnimCt = animCt;
		  
		  
		  ctx.setTransform(1,0,0,1,0,0)
		  
		  ctx.fillStyle = "white";
		  ctx.font="bold 30px arial";
		  ctx.fillText("refresh= " + animAvg.toPrecision(2),30, 500);
		  
		  ctx.setTransform(1,0,0,1,30,1200)
		  ctx.font="bold 80px arial";
		  ctx.fillText("+" + gScore, 520, 0);
		  
/*		  ctx.setTransform(10,0,0,10,30,1200)
		  ctx.drawImage(sparkle,0,0);
		  ctx.drawImage(sparkle,0,0);
		  ctx.drawImage(sparkle,0,-20);
		  ctx.drawImage(sparkle,380,0);
*/
		  
		  if (touchTime > 0) {
			  var scale = 1 - 0.2 * Math.min(1, (animCt - touchTime) / 70);
		  	  ctx.setTransform(scale,0,0,scale,30,1200)
		  }
		  if (touchTime < 0) {
//			  var scale = 1 - 0.2 * Math.min(1, (animCt - touchTime) / 200);
//		  	  ctx.setTransform(scale,0,0,scale,0,0)
		  }
		  ctx.fillText("SHAKE", 0, 0);
		  
		  ctx.restore();
		  
		  ctx.setTransform(1,0,0,1,0,0)
		  
		  if (bAudioPlay) {
			  spinner1.action(13);
			  spinner2.action(3);
			  spinner3.action(10);
			  spinner4.action(5);
			  spinner5.action(100);
			  
			  if (Math.random() < 0.1) {
				  let r = Math.random() * 6.28;
				  let x = spinner5.x + Math.cos(r) * 200;
				  let y = spinner5.y + Math.sin(r) * 200;
				  let dx = Math.cos(r-1.28) * 5;
				  let dy = Math.sin(r-1.28) * 5;
				  
				  gObjs.push(new Star(x,y,dx,dy,1000))
			  }
		  }
		  ctx.translate(100,80)
		  spinner1.render(ctx);
		  ctx.translate(180,0)
		  spinner2.render(ctx);
		  ctx.translate(180,0)
		  spinner3.render(ctx);
		  ctx.translate(180,0)
		  spinner4.render(ctx);
		  
		  ctx.restore();
		  
		  ctx.setTransform(1,0,0,1,0,0)
		  ctx.translate(spinner5.x,spinner5.y)
		  spinner5.render(ctx);
		  ctx.restore();
		  
		  window.requestAnimationFrame(AnimLoop);
	  }

	  var z = 7;
	
	  var touchTime = 0;

	  
	 function handleStart(evt) {
		 evt.preventDefault();
		 touchTime = +new Date();
		 var ctx = canvas.getContext("2d");
  		
	
		 
		 var touches = evt.changedTouches;
		 
		 for (pkey in myPoly.objs) {
			 var p = myPoly.objs[pkey];
			 console.log(touches[0].pageX);
			 if (Math.abs(p.x + p.width * 0.5 - touches[0].pageX) < p.width)
				 if (Math.abs(p.y + p.height * 0.5 - touches[0].pageY) < p.height)
			 		p.touched();
		 }
		 
		 for (let i = 0; i < 10; i++) {
				  let x = touches[0].screenX;
				  let y = touches[0].screenX;
			 	  let r = Math.random() * 6.28;
				  let dx = Math.cos(r) * 8;
				  let dy = Math.sin(r) * 8;
				  
				  gObjs.push(new Star(x,y,dx,dy,1000))
		 }
		 
		 /*
	  var q1 = new Polygon();
	  q1.x = touches[0].pageX;
	  q1.y = touches[0].pageY;
	  var title2 = Object.assign({},title1); title2.text = z; z++;
	  q1.myObjs.push(title2);
	  myPoly.objs.push(q1);*/
		 
	  };
	 	
	  function handleMove(evt) {
		  
	  }
	  function handleEnd() {
		  touchTime = -0.01;
		  
		  let obj = { x: 20, y: 600, width: 100, height: 40};
//		  effects.burst(obj, 0);
	  }
	  
	  canvas.addEventListener("touchstart", handleStart);
	  canvas.addEventListener("touchmove", handleMove);
	  canvas.addEventListener("touchend", handleEnd);

    window.requestAnimationFrame(AnimLoop);
	  
	  var words = [
		  'Bella',   'Tigger',  'Chloe' ,  'Shadow' ,  'Luna' ,  'Oreo' ,  'Oliver', 'Kitty' ,
		  'Bella',   'Tigger',  'Chloe' ,  'Shadow' ,  'Luna' ,  'Oreo' ,  'Oliver', 'Kitty' ,
		  'Bella',   'Tigger',  'Chloe' ,  'Shadow' ,  'Luna' ,  'Oreo' ,  'Oliver', 'Kitty' ,
		  'Bella',   'Tigger',  'Chloe' ,  'Shadow' ,  'Luna' ,  'Oreo' ,  'Oliver', 'Kitty' ,
		  'Bella',   'Tigger',  'Chloe' ,  'Shadow' ,  'Luna' ,  'Oreo' ,  'Oliver', 'Kitty' ,
		  'Bella',   'Tigger',  'Chloe' ,  'Shadow' ,  'Luna' ,  'Oreo' ,  'Oliver', 'Kitty' ,
				  
				  ]; 
	  var wordsR = [];
		 for (let i = 0; i < words.length; i++) {
			 wordsR.push( Math.random() * 0.2 - 0.1);
		 }
	 function myPaula(ctx){
		 ctx.setTransform(1,0,0,1,0,0)

		 let fsize = 60;
		 ctx.font= fsize + "px Permanent Marker";
//		ctx.fontFamily = "Permanent Marker";
		 
//		 ctx.fontSize = "80px";
		ctx.fillStyle = "#DDDDDD";
		 let c =0; let r = 2;
		 for (let i = 0; i < words.length; i++) {
			 dim = ctx.measureText(words[i]);
			 if (c+dim.width > canvas.width) { r++; c=0;
											 } else {
			 ctx.setTransform(1,0,0,1,1,1);
			  ctx.fillStyle = "#bb88dd";
			  ctx.fillText("*", c - 28, r * (fsize + 4));
					 }
			  ctx.fillStyle = "#DDDDDD";

			 ctx.setTransform(1,0,0,1,1,1);
			 ctx.translate(c + dim.width * 0.5, r * (fsize + 4));
			 ctx.rotate(wordsR[i]);
			 ctx.translate(dim.width * -0.5,0);
//			  ctx.fillText(words[i], c, r * (fsize + 4) );  
			  ctx.fillText(words[i], 0, 0);  
			 c+= dim.width + 30;
		 }
			 ctx.setTransform(1,0,0,1,1,1);
//		 ctx.rotate(-0.2);
		 ctx.fillText("HELLO",200,200);
	 }
	  
	  var sparkle = new Image();
	  sparkle.src =  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAHCAYAAAD5wDa1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNDNFMzM5REEyMkUxMUUzOEE3NEI3Q0U1QUIzMTc4NiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNDNFMzM5RUEyMkUxMUUzOEE3NEI3Q0U1QUIzMTc4NiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjM0M0UzMzlCQTIyRTExRTM4QTc0QjdDRTVBQjMxNzg2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjM0M0UzMzlDQTIyRTExRTM4QTc0QjdDRTVBQjMxNzg2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jzOsUQAAANhJREFUeNqsks0KhCAUhW/Sz6pFSc1AD9HL+OBFbdsVOKWLajH9EE7GFBEjOMxcUNHD8dxPBCEE/DKyLGMqraoqcd4j0ChpUmlBEGCFRBzH2dbj5JycJAn90CEpy1J2SK4apVSM4yiKonhePYwxMU2TaJrm8BpykpWmKQ3D8FbX9SOO4/tOhDEG0zRhGAZo2xaiKDLyPGeSyPM8sCxr868+WC/mvu9j13XBtm1ACME8z7AsC/R9r0fGOf+arOu6jUwS7l6tT/B+xo+aDFRo5BykHfav3/gSYAAtIdQ1IT0puAAAAABJRU5ErkJggg==";
	  

	</script>
	
</html>
